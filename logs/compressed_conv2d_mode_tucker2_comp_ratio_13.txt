-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      28.430ms         0.02%      64.255ms      32.095us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.25%        8.072s         2.25%        8.075s      14.583us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1808.33 Gb    1808.33 Gb        553728  
                                            aten::zero_         0.48%        1.733s         1.50%        5.376s      30.871us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        174144  
                                      model_performance        54.29%      194.976s        85.21%      306.018s      306.018s       0.000us         0.00%        2.500s        2.500s     -40.28 Kb     -15.38 Gb     548.50 Kb   -2130.57 Gb             1  
                                            aten::stack         0.00%       1.342ms         0.05%     177.399ms      14.783ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      79.564ms         0.18%     629.767ms     125.527us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.09%     325.384ms         0.15%     550.203ms     109.668us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.16%     558.940ms         0.16%     561.625ms      18.092us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     826.97 Gb     826.97 Gb         31043  
                                           aten::narrow         0.02%      83.031ms         0.06%     233.404ms      23.197us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     122.393ms         0.04%     150.392ms      14.945us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     120.902ms         0.03%     120.902ms       3.260us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.07%     243.336ms         0.07%     243.336ms       4.053us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     329.000us         0.02%      70.296ms       5.858ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     193.000us         0.00%       1.896ms     158.000us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.45%        1.604s         1.04%        3.738s      21.590us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        173155  
                                           aten::select         0.00%     304.000us         0.00%     363.000us      15.125us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.57%        2.031s         3.10%       11.138s      76.283us        2.498s        98.74%        2.498s      17.107us           0 b           0 b           0 b           0 b        146004  
                                               aten::to         0.25%     894.877ms         5.60%       20.125s     137.996us       0.000us         0.00%        2.497s      17.125us      15.21 Gb           0 b      35.00 Mb           0 b        145836  
                aten::_has_compatible_shallow_copy_type         0.00%     287.000us         0.00%     287.000us       1.011us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           284  
                                         aten::uniform_         0.01%      53.591ms         0.01%      53.591ms      53.591ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.14%        4.081s         2.16%        7.740s      27.254us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        284001  
                                         aten::_to_copy         0.62%        2.240s         5.35%       19.230s     132.070us       0.000us         0.00%        2.497s      17.152us      15.21 Gb           0 b      35.00 Mb           0 b        145604  
                                    aten::empty_strided         1.69%        6.061s         1.69%        6.061s      41.225us       0.000us         0.00%       0.000us       0.000us      15.21 Gb      15.21 Gb     101.10 Mb     101.10 Mb        147032  
                                        cudaMemcpyAsync         2.49%        8.957s         2.49%        8.957s      60.531us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147979  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.420ms         0.17%       4.420ms       2.210ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.06%     216.809ms         0.06%     216.809ms       1.467us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147835  
                                        aten::unsqueeze         0.00%     492.000us         0.00%     497.000us     497.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.25%     891.617ms         0.45%        1.610s      10.982us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                                 detach         0.20%     718.322ms         0.20%     718.322ms       4.900us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                            aten::clone         0.00%      54.000us         0.00%     540.000us     270.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.47%        1.671s         1.57%        5.652s       5.652ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      26.335ms         0.01%      45.230ms      45.230us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.14%       29.230s         8.14%       29.230s      14.550us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2008967  
                                              aten::mul         0.03%      95.380ms         0.04%     139.386ms      46.493us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.10 Gb      37.10 Gb          2998  
                                              aten::add         0.05%     178.250ms         0.07%     266.298ms      44.390us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.30 Gb      76.30 Gb          5999  
                                 aten::reflection_pad2d         0.20%     725.445ms         0.49%        1.775s      68.218us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.09 Gb           0 b         26026  
                                           aten::conv2d         0.16%     562.787ms         2.72%        9.772s     174.318us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb           0 b         56056  
                                      aten::convolution         0.37%        1.314s         2.56%        9.209s     164.278us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb           0 b         56056  
                                     aten::_convolution         0.34%        1.210s         2.20%        7.894s     140.831us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb           0 b         56056  
                                aten::cudnn_convolution         0.89%        3.185s         1.56%        5.618s     100.230us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb     459.15 Gb         56056  
                                        cudaEventRecord         0.15%     522.140ms         0.15%     522.140ms       2.254us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        231600  
                                        cudaBindTexture         0.15%     523.019ms         0.15%     523.019ms       4.384us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        119308  
                                      cudaUnbindTexture         0.04%     130.984ms         0.04%     130.984ms       1.098us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        119308  
                                          aten::reshape         0.06%     208.707ms         0.08%     287.241ms      11.037us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      78.534ms         0.02%      78.534ms       3.018us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.08%        7.462s         4.12%       14.796s      30.702us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        481914  
                                       aten::batch_norm         0.08%     274.199ms         1.50%        5.396s     179.695us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.28 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.09%     335.123ms         1.43%        5.122s     170.564us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.28 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.56%        2.007s         1.33%        4.787s     159.404us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.28 Gb           0 b         30030  
                                       aten::empty_like         0.15%     554.048ms         0.51%        1.824s      32.394us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1186.24 Gb           0 b         56314  
                                      aten::leaky_relu_         0.16%     578.244ms         0.27%     955.986ms      38.201us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.01%      29.060ms         0.01%      29.060ms     372.564us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            78  
                               cudaEventCreateWithFlags         0.00%       3.559ms         0.00%       3.559ms      22.814us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           156  
                                   cudaEventSynchronize         0.06%     230.374ms         0.06%     230.374ms     553.784us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           416  
                                   cudaEventElapsedTime         0.00%       1.474ms         0.00%       1.474ms       3.543us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           416  
                                        cudaEventCreate         0.00%      10.187ms         0.00%      10.187ms     195.904us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            52  
                                    cudaStreamWaitEvent         0.00%       5.533ms         0.00%       5.533ms       0.893us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          6198  
                                       cudaEventDestroy         0.00%     204.000us         0.00%     204.000us       0.981us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           208  
                                               cudaFree         0.01%      18.406ms         0.01%      18.406ms     836.636us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            22  
                                             cudaMalloc         0.01%      46.507ms         0.01%      46.507ms       1.453ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            32  
                              aten::upsample_bilinear2d         0.06%     229.080ms         0.09%     313.436ms      62.625us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      43.199ms         0.02%      63.355ms      63.292us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       3.057ms         0.00%       3.057ms       3.057us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      45.800ms         0.06%     210.221ms     210.221us       0.000us         0.00%     169.000us       0.169us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.03%      93.058ms         0.04%     127.334ms     127.334us     169.000us         0.01%     169.000us       0.169us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.25%     905.885ms         0.25%     905.885ms      15.327us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         59104  
                                        aten::ones_like         0.00%      12.473ms         0.02%      68.072ms      68.072us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      29.732ms         1.18%      29.732ms       0.618us           0 b           0 b           0 b           0 b         48093  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      45.186ms         0.11%     389.298ms     389.298us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      33.879ms         0.10%     344.112ms     344.112us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.03%      93.285ms         0.10%     375.300ms     187.650us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.10%     361.162ms         0.68%        2.447s      96.782us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     591.99 Gb           0 b         25284  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      41.566ms         0.04%     153.215ms     153.215us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     646.50 Kb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      26.846ms         0.03%     111.649ms     111.649us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      55.492ms         0.02%      84.803ms      84.803us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.64%        2.301s         6.61%       23.724s     423.635us       0.000us         0.00%      29.563ms       0.528us           0 b           0 b    -530.10 Gb   -1166.42 Gb         56000  
                                   ConvolutionBackward0         0.32%        1.163s         5.97%       21.422s     382.538us       0.000us         0.00%      29.563ms       0.528us           0 b           0 b     636.32 Gb           0 b         56000  
                             aten::convolution_backward         2.69%        9.653s         5.64%       20.260s     361.777us      29.188ms         1.15%      29.563ms       0.528us           0 b           0 b     636.32 Gb     620.74 Gb         56000  
                                              aten::sum         0.48%        1.741s         0.66%        2.377s      91.414us     375.000us         0.01%     375.000us       0.014us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.60%        5.743s         3.60%       12.939s      91.121us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -535.11 Mb    -535.64 Mb        142000  
                        torch::autograd::AccumulateGrad         0.46%        1.636s         2.00%        7.196s      50.677us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     548.50 Kb           0 b        142000  
                                aten::new_empty_strided         0.01%      50.256ms         0.03%      93.488ms     658.366us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     548.50 Kb           0 b           142  
autograd::engine::evaluate_function: ReflectionPad2D...         0.24%     875.492ms         1.21%        4.350s     181.251us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -216.56 Gb    -847.75 Gb         24000  
                               ReflectionPad2DBackward0         0.09%     307.329ms         0.92%        3.292s     137.148us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.06 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.14%     490.821ms         0.83%        2.984s     124.342us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.06 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.42%        1.492s         0.91%        3.272s     130.870us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -589.50 Gb   -1011.10 Gb         25000  
                                     LeakyReluBackward1         0.09%     337.434ms         0.50%        1.780s      71.195us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     421.60 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.26%     944.531ms         0.40%        1.442s      57.698us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     421.60 Gb     421.60 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.51%        1.836s         1.99%        7.161s     238.702us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -592.64 Gb   -1187.02 Gb         30000  
                                CudnnBatchNormBackward0         0.16%     574.616ms         1.48%        5.325s     177.498us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.38 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.53%        1.895s         1.32%        4.750s     158.344us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.38 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      73.296ms         0.11%     383.498ms      76.700us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      78.722ms         0.09%     310.202ms      62.040us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      71.762ms         0.20%     707.916ms     141.583us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.63 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      52.664ms         0.18%     636.154ms     127.231us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.63 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.08%     280.612ms         0.16%     583.490ms     116.698us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.63 Gb      41.63 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.495s        98.65%        2.495s      16.880us           0 b           0 b           0 b           0 b        147830  
                                             aten::item         0.01%      21.283ms         0.03%     113.101ms      56.550us       0.000us         0.00%       2.098ms       1.049us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      24.980ms         0.03%      91.818ms      45.909us       2.098ms         0.08%       2.098ms       1.049us           0 b           0 b           0 b           0 b          2000  
                               Optimizer.step#Adam.step         7.60%       27.289s        17.49%       62.795s      62.795ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb       1.07 Mb      -1.05 Gb          1000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 359.124s
Self CUDA time total: 2.530s
