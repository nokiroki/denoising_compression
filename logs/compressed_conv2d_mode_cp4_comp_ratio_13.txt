-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      31.729ms         0.02%      85.299ms      42.607us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.98%       11.207s         2.98%       11.213s      19.207us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1796.14 Gb    1796.14 Gb        583773  
                                            aten::zero_         0.51%        1.929s         1.54%        5.787s      30.594us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        189159  
                                      model_performance        52.23%      196.649s        86.15%      324.360s      324.360s       0.000us         0.00%        2.597s        2.597s    -134.55 Kb     -15.26 Gb     425.00 Kb   -2104.82 Gb             1  
                                            aten::stack         0.00%     506.000us         0.05%     178.600ms      14.883ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      82.855ms         0.17%     642.929ms     128.150us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.09%     330.096ms         0.15%     560.074ms     111.635us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.62%        2.324s         0.62%        2.332s      19.258us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     847.67 Gb     847.67 Gb        121073  
                                           aten::narrow         0.02%      80.603ms         0.06%     225.497ms      22.411us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     118.355ms         0.04%     144.929ms      14.402us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     116.672ms         0.03%     116.672ms       3.146us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     237.082ms         0.06%     237.082ms       3.949us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     336.000us         0.02%      83.336ms       6.945ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     184.000us         0.00%       6.863ms     571.917us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.46%        1.716s         1.05%        3.962s      21.055us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        188170  
                                           aten::select         0.00%     348.000us         0.00%     400.000us      16.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.59%        2.218s         4.54%       17.112s     106.360us        2.595s        99.60%        2.595s      16.127us           0 b           0 b           0 b           0 b        160884  
                                               aten::to         0.26%     986.205ms         6.15%       23.136s     143.971us       0.000us         0.00%        2.594s      16.143us      15.08 Gb           0 b      35.00 Mb           0 b        160701  
                aten::_has_compatible_shallow_copy_type         0.00%     257.000us         0.00%     257.000us       0.818us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           314  
                                         aten::uniform_         0.01%      55.386ms         0.01%      55.386ms      55.386ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.20%        4.526s         2.27%        8.556s      27.247us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        314001  
                                         aten::_to_copy         0.66%        2.493s         5.88%       22.150s     138.047us       0.000us         0.00%        2.594s      16.168us      15.08 Gb           0 b      35.00 Mb           0 b        160454  
                                    aten::empty_strided         0.72%        2.728s         0.72%        2.728s      16.846us       0.000us         0.00%       0.000us       0.000us      15.08 Gb      15.08 Gb     100.73 Mb     100.73 Mb        161927  
                                        cudaMemcpyAsync         3.91%       14.723s         3.91%       14.723s      90.405us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162859  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.583ms         0.18%       4.583ms       2.292ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.06%     240.041ms         0.06%     240.041ms       1.475us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162700  
                                        aten::unsqueeze         0.00%      31.000us         0.00%      36.000us      36.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.29%        1.076s         0.50%        1.865s      11.553us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                                 detach         0.21%     789.455ms         0.21%     789.455ms       4.890us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                            aten::clone         0.00%      36.000us         0.00%     288.000us     144.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.48%        1.821s         1.67%        6.287s       6.287ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      26.407ms         0.01%      45.166ms      45.166us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.27%       31.134s         8.27%       31.134s      14.373us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2166201  
                                              aten::mul         0.03%     100.081ms         0.04%     144.512ms      48.203us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.46 Gb      37.46 Gb          2998  
                                              aten::add         0.05%     175.909ms         0.07%     262.546ms      43.765us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.05 Gb      76.05 Gb          5999  
                                 aten::reflection_pad2d         0.20%     738.416ms         0.48%        1.806s      69.376us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     656.03 Gb           0 b         26026  
                                           aten::conv2d         0.19%     707.619ms         2.95%       11.118s     156.431us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     440.34 Gb           0 b         71071  
                                      aten::convolution         0.44%        1.656s         2.76%       10.410s     146.475us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     440.34 Gb           0 b         71071  
                                     aten::_convolution         0.43%        1.624s         2.33%        8.754s     123.178us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     440.34 Gb           0 b         71071  
                                aten::cudnn_convolution         0.61%        2.300s         1.10%        4.125s     100.518us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     431.12 Gb     426.11 Gb         41041  
                                        cudaEventRecord         0.11%     414.699ms         0.11%     414.699ms       2.278us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        182042  
                                        cudaBindTexture         0.11%     426.410ms         0.11%     426.410ms       4.675us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         91201  
                                      cudaUnbindTexture         0.03%      98.412ms         0.03%      98.412ms       1.079us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         91201  
                                          aten::reshape         0.06%     224.138ms         0.08%     304.058ms      11.683us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      79.920ms         0.02%      79.920ms       3.071us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.12%        7.970s         4.21%       15.839s      30.062us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        526899  
                                       aten::batch_norm         0.07%     276.934ms         1.76%        6.642s     221.166us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.25 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.10%     363.769ms         1.69%        6.365s     211.944us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.25 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.54%        2.025s         1.59%        6.001s     199.831us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.25 Gb           0 b         30030  
                                       aten::empty_like         0.15%     548.681ms         1.36%        5.123s      90.920us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1186.43 Gb           0 b         56344  
                                      aten::leaky_relu_         0.15%     576.964ms         0.25%     958.300ms      38.294us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.00%      11.038ms         0.00%      11.038ms     220.760us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            50  
                                             cudaMalloc         0.02%      87.362ms         0.02%      87.362ms       1.481ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            59  
                               cudaEventCreateWithFlags         0.00%     192.000us         0.00%     192.000us       1.920us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           100  
                                   cudaEventSynchronize         0.03%     119.223ms         0.03%     119.223ms     471.237us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           253  
                                   cudaEventElapsedTime         0.00%       1.048ms         0.00%       1.048ms       4.142us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           253  
                                        cudaEventCreate         0.00%      81.000us         0.00%      81.000us       2.455us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            33  
                                    cudaStreamWaitEvent         0.00%     267.000us         0.00%     267.000us       0.359us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           744  
                                       cudaEventDestroy         0.00%     150.000us         0.00%     150.000us       1.128us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           133  
                                               cudaFree         0.01%      21.705ms         0.01%      21.705ms     775.179us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            28  
                                aten::_conv_depthwise2d         0.17%     647.776ms         0.50%        1.894s      63.065us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       9.22 Gb           0 b         30030  
                              aten::upsample_bilinear2d         0.06%     231.566ms         0.08%     312.324ms      62.402us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      40.869ms         0.02%      64.819ms      64.754us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.91 Gb       3.91 Gb          1001  
                                aten::broadcast_tensors         0.00%       3.136ms         0.00%       3.136ms       3.136us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      49.594ms         0.06%     213.504ms     213.504us       0.000us         0.00%     163.000us       0.163us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.02%      90.852ms         0.03%     126.370ms     126.370us     163.000us         0.01%     163.000us       0.163us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.29%        1.092s         0.29%        1.092s      23.706us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         46068  
                                        aten::ones_like         0.00%      13.206ms         0.02%      69.159ms      69.159us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       8.269ms         0.32%       8.269ms       0.197us           0 b           0 b           0 b           0 b         42068  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      43.693ms         0.12%     440.310ms     440.310us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      38.188ms         0.11%     396.617ms     396.617us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.03%      96.489ms         0.11%     417.900ms     208.950us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     336.634ms         1.23%        4.649s     183.648us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     592.21 Gb           0 b         25314  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      33.378ms         0.04%     153.150ms     153.150us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     366.18 Mb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      19.203ms         0.03%     119.772ms     119.772us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.29 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      70.115ms         0.03%     100.569ms     100.569us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.29 Gb       3.29 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.74%        2.772s         6.03%       22.719s     319.986us       0.000us         0.00%       8.106ms       0.114us           0 b           0 b    -502.84 Gb   -1110.66 Gb         71000  
                                   ConvolutionBackward0         0.37%        1.410s         5.30%       19.947s     280.947us       0.000us         0.00%       8.106ms       0.114us           0 b           0 b     607.82 Gb           0 b         71000  
                             aten::convolution_backward         1.95%        7.339s         4.92%       18.537s     261.081us       7.466ms         0.29%       8.106ms       0.114us           0 b           0 b     607.82 Gb     589.35 Gb         71000  
                                              aten::sum         0.44%        1.638s         0.59%        2.221s      85.411us     640.000us         0.02%     640.000us       0.025us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.08%        4.078s         3.05%       11.484s      73.149us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -414.62 Mb    -415.04 Mb        157000  
                        torch::autograd::AccumulateGrad         0.44%        1.656s         1.97%        7.406s      47.174us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     425.00 Kb           0 b        157000  
                                aten::new_empty_strided         0.00%       1.282ms         0.01%      26.398ms     168.140us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     425.00 Kb           0 b           157  
autograd::engine::evaluate_function: ReflectionPad2D...         0.23%     861.621ms         1.71%        6.438s     268.266us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -216.77 Gb    -847.93 Gb         24000  
                               ReflectionPad2DBackward0         0.07%     276.011ms         1.43%        5.396s     224.835us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.28 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.12%     453.848ms         1.36%        5.120s     213.335us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.28 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.23%     861.211ms         0.68%        2.576s     103.037us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -588.08 Gb   -1010.51 Gb         25000  
                                     LeakyReluBackward1         0.09%     337.579ms         0.46%        1.715s      68.588us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     422.43 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.24%     903.793ms         0.37%        1.377s      55.085us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     422.43 Gb     422.43 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.57%        2.156s         1.93%        7.256s     241.869us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -594.17 Gb   -1187.98 Gb         30000  
                                CudnnBatchNormBackward0         0.14%     510.835ms         1.35%        5.100s     170.014us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.81 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.48%        1.808s         1.22%        4.590s     152.986us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.81 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      70.651ms         0.10%     368.588ms      73.718us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      74.410ms         0.08%     297.937ms      59.587us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      70.951ms         0.18%     675.104ms     135.021us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.63 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      49.586ms         0.16%     604.153ms     120.831us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.63 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.07%     269.334ms         0.15%     554.567ms     110.913us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.63 Gb      41.63 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.592s        99.51%        2.592s      15.932us           0 b           0 b           0 b           0 b        162697  
                                             aten::item         0.01%      23.601ms         0.03%     114.903ms      57.452us       0.000us         0.00%       2.072ms       1.036us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      21.840ms         0.02%      91.302ms      45.651us       2.072ms         0.08%       2.072ms       1.036us           0 b           0 b           0 b           0 b          2000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 376.497s
Self CUDA time total: 2.605s
