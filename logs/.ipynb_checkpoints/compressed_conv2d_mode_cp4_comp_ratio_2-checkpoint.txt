-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      24.870ms         0.01%      59.018ms      29.480us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         1.92%        7.630s         1.92%        7.635s      13.079us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1806.38 Gb    1806.38 Gb        583773  
                                            aten::zero_         0.42%        1.658s         1.38%        5.497s      29.060us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        189159  
                                      model_performance        50.16%      199.249s        86.65%      344.190s      344.190s       0.000us         0.00%        1.932s        1.932s      60.20 Kb     -18.82 Gb       3.71 Mb   -3694.12 Gb             1  
                                            aten::stack         0.00%     372.000us         0.04%     149.368ms      12.447ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      71.049ms         0.14%     574.124ms     114.436us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.07%     281.684ms         0.13%     503.075ms     100.274us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.55%        2.166s         0.55%        2.169s      17.912us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb    2954.25 Gb    2954.25 Gb        121073  
                                           aten::narrow         0.02%      80.143ms         0.06%     228.856ms      22.745us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     120.970ms         0.04%     148.739ms      14.781us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     125.468ms         0.03%     125.468ms       3.383us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     231.101ms         0.06%     231.101ms       3.849us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     340.000us         0.02%      64.094ms       5.341ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     186.000us         0.00%       2.697ms     224.750us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.43%        1.695s         0.99%        3.928s      20.877us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        188170  
                                           aten::select         0.00%     304.000us         0.00%     353.000us      14.708us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.55%        2.182s        11.14%       44.251s     275.049us        1.931s        99.86%        1.931s      12.005us           0 b           0 b           0 b           0 b        160884  
                                               aten::to         0.21%     841.639ms        12.64%       50.201s     312.385us       0.000us         0.00%        1.931s      12.019us      18.65 Gb           0 b      35.00 Mb           0 b        160701  
                aten::_has_compatible_shallow_copy_type         0.00%     240.000us         0.00%     240.000us       0.764us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           314  
                                         aten::uniform_         0.01%      52.256ms         0.01%      52.256ms      52.256ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.11%        4.428s         2.10%        8.337s      26.551us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        314001  
                                         aten::_to_copy         0.53%        2.093s        12.43%       49.359s     307.621us       0.000us         0.00%        1.931s      12.037us      18.65 Gb           0 b      35.00 Mb           0 b        160454  
                                    aten::empty_strided         0.80%        3.166s         0.80%        3.171s      19.582us       0.000us         0.00%       0.000us       0.000us      18.65 Gb      18.65 Gb     111.78 Mb     111.78 Mb        161927  
                                        cudaMemcpyAsync        10.54%       41.874s        10.54%       41.874s     257.120us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162859  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.589ms         0.24%       4.589ms       2.295ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.07%     262.362ms         0.07%     262.362ms       1.613us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162700  
                                        aten::unsqueeze         0.00%      39.000us         0.00%      46.000us      46.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.20%     794.229ms         0.38%        1.514s       9.378us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                                 detach         0.18%     719.955ms         0.18%     719.955ms       4.459us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                            aten::clone         0.00%      39.000us         0.00%     606.000us     303.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.40%        1.607s         1.44%        5.718s       5.718ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      25.940ms         0.01%      44.807ms      44.807us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         7.69%       30.551s         7.69%       30.551s      14.005us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2181428  
                                              aten::mul         0.02%      88.883ms         0.03%     131.915ms      44.001us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.17 Gb      37.17 Gb          2998  
                                              aten::add         0.05%     182.197ms         0.07%     270.504ms      45.092us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.66 Gb      76.66 Gb          5999  
                                 aten::reflection_pad2d         0.16%     647.008ms         0.41%        1.636s      62.855us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.13 Gb           0 b         26026  
                                           aten::conv2d         0.14%     547.866ms         2.51%        9.967s     140.240us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    2032.27 Gb           0 b         71071  
                                      aten::convolution         0.32%        1.257s         2.37%        9.419s     132.531us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    2032.27 Gb           0 b         71071  
                                     aten::_convolution         0.30%        1.201s         2.05%        8.162s     114.847us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    2032.27 Gb           0 b         71071  
                                aten::cudnn_convolution         0.59%        2.356s         1.07%        4.265s     103.919us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1041.46 Gb    1033.67 Gb         41041  
                                        cudaEventRecord         0.11%     430.059ms         0.11%     430.059ms       2.360us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        182209  
                                        cudaBindTexture         0.08%     333.160ms         0.08%     333.160ms       4.488us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         74238  
                                      cudaUnbindTexture         0.02%      81.814ms         0.02%      81.814ms       1.102us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         74238  
                                          aten::reshape         0.04%     165.331ms         0.06%     238.120ms       9.149us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      72.789ms         0.02%      72.789ms       2.797us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.02%        8.034s         3.94%       15.632s      29.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        526899  
                                       aten::batch_norm         0.05%     217.741ms         1.23%        4.871s     162.202us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.07%     259.385ms         1.17%        4.653s     154.952us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.46%        1.842s         1.11%        4.394s     146.314us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                       aten::empty_like         0.12%     492.610ms         0.42%        1.673s      29.700us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1186.94 Gb           0 b         56344  
                                      aten::leaky_relu_         0.14%     547.796ms         0.23%     912.183ms      36.451us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.00%       7.284ms         0.00%       7.284ms     112.062us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            65  
                               cudaEventCreateWithFlags         0.00%     556.000us         0.00%     556.000us       4.277us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           130  
                                   cudaEventSynchronize         0.10%     383.772ms         0.10%     383.772ms       1.246ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           308  
                                   cudaEventElapsedTime         0.00%       1.989ms         0.00%       1.989ms       6.458us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           308  
                                        cudaEventCreate         0.00%     140.000us         0.00%     140.000us       3.256us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            43  
                                    cudaStreamWaitEvent         0.00%     706.000us         0.00%     706.000us       0.755us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           935  
                                       cudaEventDestroy         0.00%     365.000us         0.00%     365.000us       2.110us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           173  
                                               cudaFree         0.00%       2.879ms         0.00%       2.879ms     319.889us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             9  
                                aten::_conv_depthwise2d         0.14%     561.247ms         0.43%        1.699s      56.586us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     990.81 Gb           0 b         30030  
                                             cudaMalloc         0.00%      14.669ms         0.00%      14.669ms     862.882us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            17  
                              aten::upsample_bilinear2d         0.05%     201.245ms         0.07%     280.544ms      56.053us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      42.821ms         0.02%      62.884ms      62.821us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       2.631ms         0.00%       2.631ms       2.631us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      42.836ms         0.05%     197.959ms     197.959us       0.000us         0.00%     122.000us       0.122us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.02%      86.158ms         0.03%     119.159ms     119.159us     122.000us         0.01%     122.000us       0.122us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.24%     952.514ms         0.24%     952.514ms      20.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         46088  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       1.893ms         0.10%       1.893ms       0.157us           0 b           0 b           0 b           0 b         12042  
                                        aten::ones_like         0.00%      10.800ms         0.02%      64.376ms      64.376us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      37.054ms         0.08%     333.421ms     333.421us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      24.496ms         0.07%     296.367ms     296.367us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.02%      67.724ms         0.09%     344.267ms     172.133us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     343.125ms         0.60%        2.366s      93.460us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.17 Gb           0 b         25314  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      34.405ms         0.04%     140.113ms     140.113us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      48.29 Mb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      20.167ms         0.03%     105.708ms     105.708us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.98 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.01%      55.615ms         0.02%      85.541ms      85.541us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.98 Gb       2.98 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         1.42%        5.622s         6.46%       25.670s     361.546us       0.000us         0.00%       1.771ms       0.025us           0 b           0 b   -2086.57 Gb   -4292.36 Gb         71000  
                                   ConvolutionBackward0         0.33%        1.327s         5.05%       20.048s     282.363us       0.000us         0.00%       1.771ms       0.025us           0 b           0 b    2205.79 Gb           0 b         71000  
                             aten::convolution_backward         1.88%        7.467s         4.71%       18.721s     263.671us       1.392ms         0.07%       1.771ms       0.025us           0 b           0 b    2205.79 Gb    1055.87 Gb         71000  
                                              aten::sum         0.43%        1.726s         0.59%        2.328s      89.532us     379.000us         0.02%     379.000us       0.015us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.06%        4.196s         2.95%       11.703s      74.540us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      -4.00 Gb      -4.00 Gb        157000  
                        torch::autograd::AccumulateGrad         0.43%        1.688s         1.89%        7.506s      47.811us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       4.10 Mb           0 b        157000  
                                aten::new_empty_strided         0.00%       3.990ms         0.00%      14.207ms      90.490us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       4.10 Mb           0 b           157  
autograd::engine::evaluate_function: ReflectionPad2D...         0.22%     880.997ms         1.08%        4.305s     179.370us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -217.80 Gb    -850.52 Gb         24000  
                               ReflectionPad2DBackward0         0.08%     300.291ms         0.81%        3.236s     134.838us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.24 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.13%     501.728ms         0.74%        2.936s     122.325us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.24 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.22%     872.217ms         0.67%        2.651s     106.030us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -589.57 Gb   -1012.96 Gb         25000  
                                     LeakyReluBackward1         0.08%     337.054ms         0.45%        1.779s      71.142us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.39 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.24%     943.473ms         0.36%        1.441s      57.660us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.39 Gb     423.39 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.45%        1.792s         1.76%        6.998s     233.273us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -594.28 Gb   -1189.50 Gb         30000  
                                CudnnBatchNormBackward0         0.13%     500.808ms         1.31%        5.206s     173.546us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.22 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.47%        1.868s         1.18%        4.706s     156.853us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.22 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      74.371ms         0.09%     375.910ms      75.182us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      74.262ms         0.08%     301.539ms      60.308us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      72.301ms         0.18%     697.527ms     139.505us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      50.978ms         0.16%     625.226ms     125.045us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.07%     274.677ms         0.14%     574.248ms     114.850us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb      42.60 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        1.928s        99.66%        1.928s      19.067us           0 b           0 b           0 b           0 b        101095  
                                             aten::item         0.01%      20.140ms         0.03%     104.541ms      52.270us       0.000us         0.00%     774.000us       0.387us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      24.134ms         0.02%      84.401ms      42.200us     774.000us         0.04%     774.000us       0.387us           0 b           0 b           0 b           0 b          2000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 397.216s
Self CUDA time total: 1.934s
