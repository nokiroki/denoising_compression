-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      31.016ms         0.02%      72.217ms      36.072us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.21%        8.492s         2.21%        8.493s      15.338us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1802.16 Gb    1802.16 Gb        553728  
                                            aten::zero_         0.49%        1.883s         1.52%        5.849s      33.586us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        174144  
                                      model_performance        53.95%      207.533s        86.28%      331.900s      331.900s       0.000us         0.00%        2.591s        2.591s    -219.58 Kb     -15.43 Gb       1.47 Mb   -2138.10 Gb             1  
                                            aten::stack         0.00%     503.000us         0.05%     174.656ms      14.555ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      88.393ms         0.18%     678.200ms     135.180us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.09%     341.567ms         0.15%     589.807ms     117.562us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.16%     609.224ms         0.16%     610.247ms      19.658us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     826.96 Gb     826.96 Gb         31043  
                                           aten::narrow         0.02%      81.946ms         0.06%     234.612ms      23.317us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     124.725ms         0.04%     152.682ms      15.173us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     124.490ms         0.03%     124.490ms       3.357us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.07%     257.577ms         0.07%     257.577ms       4.290us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     250.000us         0.02%      59.164ms       4.930ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     118.000us         0.00%     664.000us      55.333us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.46%        1.765s         1.06%        4.059s      23.443us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        173155  
                                           aten::select         0.00%     274.000us         0.00%     326.000us      13.583us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.58%        2.227s         2.97%       11.417s      78.198us        2.589s        99.48%        2.589s      17.731us           0 b           0 b           0 b           0 b        146004  
                                               aten::to         0.25%     968.049ms         4.49%       17.276s     118.459us       0.000us         0.00%        2.589s      17.750us      15.25 Gb           0 b      35.00 Mb           0 b        145836  
                aten::_has_compatible_shallow_copy_type         0.00%     285.000us         0.00%     285.000us       1.004us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           284  
                                         aten::uniform_         0.02%      69.327ms         0.02%      69.327ms      69.327ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.19%        4.595s         2.26%        8.676s      30.548us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        284001  
                                         aten::_to_copy         0.62%        2.390s         4.24%       16.308s     111.999us       0.000us         0.00%        2.589s      17.778us      15.25 Gb           0 b      35.00 Mb           0 b        145604  
                                    aten::empty_strided         0.70%        2.698s         0.70%        2.698s      18.349us       0.000us         0.00%       0.000us       0.000us      15.25 Gb      15.25 Gb     101.24 Mb     101.24 Mb        147032  
                                        cudaMemcpyAsync         2.34%        8.996s         2.34%        8.996s      60.792us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147979  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.633ms         0.18%       4.633ms       2.317ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.07%     270.570ms         0.07%     270.570ms       1.830us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147835  
                                        aten::unsqueeze         0.00%      52.000us         0.00%      56.000us      56.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.24%     925.182ms         0.45%        1.714s      11.695us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                                 detach         0.21%     789.313ms         0.21%     789.313ms       5.384us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                            aten::clone         0.00%      48.000us         0.00%     320.000us     160.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.47%        1.817s         1.62%        6.222s       6.222ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      29.337ms         0.01%      50.602ms      50.602us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.17%       31.437s         8.17%       31.437s      15.633us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2011004  
                                              aten::mul         0.03%     106.405ms         0.04%     160.401ms      53.503us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.24 Gb      37.24 Gb          2998  
                                              aten::add         0.05%     187.341ms         0.07%     285.097ms      47.524us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.23 Gb      76.23 Gb          5999  
                                 aten::reflection_pad2d         0.21%     816.772ms         0.51%        1.969s      75.638us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.09 Gb           0 b         26026  
                                           aten::conv2d         0.16%     597.275ms         2.79%       10.744s     191.659us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     475.77 Gb           0 b         56056  
                                      aten::convolution         0.38%        1.447s         2.64%       10.146s     181.004us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     475.77 Gb           0 b         56056  
                                     aten::_convolution         0.34%        1.311s         2.26%        8.700s     155.194us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     475.77 Gb           0 b         56056  
                                aten::cudnn_convolution         0.91%        3.499s         1.62%        6.213s     110.831us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     475.77 Gb     467.10 Gb         56056  
                                        cudaEventRecord         0.14%     541.494ms         0.14%     541.494ms       2.379us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        227618  
                                        cudaBindTexture         0.15%     578.541ms         0.15%     578.541ms       4.617us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        125309  
                                      cudaUnbindTexture         0.04%     139.527ms         0.04%     139.527ms       1.113us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        125309  
                                          aten::reshape         0.06%     222.076ms         0.08%     312.127ms      11.993us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      90.051ms         0.02%      90.051ms       3.460us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.14%        8.222s         4.12%       15.831s      32.851us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        481914  
                                       aten::batch_norm         0.08%     289.855ms         1.55%        5.971s     198.841us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.09%     364.352ms         1.48%        5.681s     189.188us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.58%        2.234s         1.38%        5.317s     177.055us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                       aten::empty_like         0.15%     582.099ms         0.50%        1.939s      34.439us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1186.05 Gb           0 b         56314  
                                      aten::leaky_relu_         0.17%     645.396ms         0.28%        1.065s      42.541us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.01%      22.051ms         0.01%      22.051ms     282.705us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            78  
                               cudaEventCreateWithFlags         0.00%      12.249ms         0.00%      12.249ms      78.519us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           156  
                                   cudaEventSynchronize         0.07%     263.951ms         0.07%     263.951ms     634.498us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           416  
                                   cudaEventElapsedTime         0.00%       1.750ms         0.00%       1.750ms       4.207us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           416  
                                        cudaEventCreate         0.00%       7.904ms         0.00%       7.904ms     152.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            52  
                                    cudaStreamWaitEvent         0.00%       1.052ms         0.00%       1.052ms       0.475us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2215  
                                       cudaEventDestroy         0.00%     255.000us         0.00%     255.000us       1.226us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           208  
                                               cudaFree         0.00%       7.508ms         0.00%       7.508ms     625.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12  
                                             cudaMalloc         0.00%       6.695ms         0.00%       6.695ms     478.214us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            14  
                              aten::upsample_bilinear2d         0.07%     251.762ms         0.09%     343.587ms      68.649us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      45.214ms         0.02%      67.686ms      67.618us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.94 Gb       2.94 Gb          1001  
                                aten::broadcast_tensors         0.00%       3.378ms         0.00%       3.378ms       3.378us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      50.936ms         0.06%     233.411ms     233.411us       0.000us         0.00%     219.000us       0.219us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.03%     102.056ms         0.04%     141.304ms     141.304us     219.000us         0.01%     219.000us       0.219us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.37%        1.433s         0.37%        1.433s      24.655us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         58104  
                                        aten::ones_like         0.00%      14.032ms         0.02%      79.389ms      79.389us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      11.434ms         0.44%      11.434ms       0.475us           0 b           0 b           0 b           0 b         24071  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      49.869ms         0.14%     533.463ms     533.463us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      37.472ms         0.13%     483.594ms     483.594us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.04%     155.479ms         0.15%     569.848ms     284.924us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     353.320ms         0.65%        2.512s      99.338us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     592.28 Gb           0 b         25284  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      37.478ms         0.04%     150.250ms     150.250us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     143.71 Mb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      21.021ms         0.03%     112.772ms     112.772us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.07 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      60.129ms         0.02%      91.751ms      91.751us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.07 Gb       3.07 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.70%        2.686s         6.54%       25.147s     449.058us       0.000us         0.00%      11.215ms       0.200us           0 b           0 b    -537.48 Gb   -1182.27 Gb         56000  
                                   ConvolutionBackward0         0.29%        1.119s         5.84%       22.462s     401.100us       0.000us         0.00%      11.215ms       0.200us           0 b           0 b     644.79 Gb           0 b         56000  
                             aten::convolution_backward         2.61%       10.021s         5.55%       21.343s     381.123us      10.472ms         0.40%      11.215ms       0.200us           0 b           0 b     644.79 Gb     633.69 Gb         56000  
                                              aten::sum         0.47%        1.804s         0.64%        2.443s      93.976us     743.000us         0.03%     743.000us       0.029us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.01%        3.869s         2.87%       11.055s      77.853us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -582.91 Mb    -583.50 Mb        142000  
                        torch::autograd::AccumulateGrad         0.43%        1.656s         1.87%        7.187s      50.609us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     597.50 Kb           0 b        142000  
                                aten::new_empty_strided         0.02%      62.456ms         0.03%     106.203ms     747.908us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     597.50 Kb           0 b           142  
autograd::engine::evaluate_function: ReflectionPad2D...         0.23%     887.876ms         1.14%        4.377s     182.386us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -216.00 Gb    -846.97 Gb         24000  
                               ReflectionPad2DBackward0         0.08%     302.554ms         0.86%        3.296s     137.344us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.35 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.13%     488.022ms         0.78%        2.994s     124.738us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.35 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.24%     905.206ms         0.70%        2.707s     108.273us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -587.81 Gb   -1009.78 Gb         25000  
                                     LeakyReluBackward1         0.09%     347.078ms         0.47%        1.802s      72.065us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     421.96 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.25%     954.101ms         0.38%        1.455s      58.181us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     421.96 Gb     421.96 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.56%        2.173s         1.99%        7.653s     255.093us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -594.57 Gb   -1187.96 Gb         30000  
                                CudnnBatchNormBackward0         0.15%     574.124ms         1.42%        5.479s     182.650us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.40 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.51%        1.945s         1.28%        4.905s     163.512us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.40 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      76.687ms         0.10%     385.663ms      77.133us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      77.745ms         0.08%     308.976ms      61.795us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      75.362ms         0.19%     717.721ms     143.544us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.65 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      52.598ms         0.17%     642.359ms     128.472us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.65 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.08%     289.840ms         0.15%     589.761ms     117.952us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      41.65 Gb      41.65 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.586s        99.38%        2.586s      17.495us           0 b           0 b           0 b           0 b        147831  
                                             aten::item         0.01%      20.772ms         0.03%     120.388ms      60.194us       0.000us         0.00%       2.081ms       1.040us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      24.085ms         0.03%      99.616ms      49.808us       2.081ms         0.08%       2.081ms       1.040us           0 b           0 b           0 b           0 b          2000  
                               Optimizer.step#Adam.step         8.34%       32.090s        19.81%       76.185s      76.185ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb       1.17 Mb      -1.14 Gb          1000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 384.656s
Self CUDA time total: 2.602s
