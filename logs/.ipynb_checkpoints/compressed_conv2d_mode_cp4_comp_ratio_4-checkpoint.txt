-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      26.139ms         0.02%      69.820ms      34.875us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.17%        8.157s         2.17%        8.175s      14.003us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1806.12 Gb    1806.12 Gb        583773  
                                            aten::zero_         0.48%        1.793s         1.54%        5.804s      30.685us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        189159  
                                      model_performance        51.98%      195.516s        86.34%      324.802s      324.802s       0.000us         0.00%        2.480s        2.480s      10.23 Kb     -16.69 Gb       1.89 Mb   -2743.58 Gb             1  
                                            aten::stack         0.00%     440.000us         0.04%     163.118ms      13.593ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      76.742ms         0.16%     609.188ms     121.425us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.08%     306.078ms         0.14%     532.446ms     106.128us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.61%        2.292s         0.61%        2.305s      19.037us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb    1696.24 Gb    1696.24 Gb        121073  
                                           aten::narrow         0.02%      82.091ms         0.06%     228.917ms      22.751us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     119.171ms         0.04%     146.851ms      14.593us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     122.517ms         0.03%     122.517ms       3.303us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     237.022ms         0.06%     237.022ms       3.948us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     293.000us         0.02%      71.710ms       5.976ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     149.000us         0.00%       1.224ms     102.000us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.49%        1.833s         1.09%        4.111s      21.846us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        188170  
                                           aten::select         0.00%     266.000us         0.00%     311.000us      12.958us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.61%        2.301s         5.36%       20.165s     125.337us        2.479s        99.86%        2.479s      15.407us           0 b           0 b           0 b           0 b        160884  
                                               aten::to         0.24%     885.517ms         7.09%       26.653s     165.853us       0.000us         0.00%        2.478s      15.422us      16.52 Gb           0 b      35.00 Mb           0 b        160701  
                aten::_has_compatible_shallow_copy_type         0.00%     272.000us         0.00%     272.000us       0.866us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           314  
                                         aten::uniform_         0.02%      74.023ms         0.02%      74.023ms      74.023ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.22%        4.586s         2.29%        8.631s      27.487us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        314001  
                                         aten::_to_copy         0.60%        2.246s         6.85%       25.767s     160.589us       0.000us         0.00%        2.478s      15.446us      16.52 Gb           0 b      35.00 Mb           0 b        160454  
                                    aten::empty_strided         0.94%        3.536s         0.94%        3.536s      21.837us       0.000us         0.00%       0.000us       0.000us      16.52 Gb      16.52 Gb     105.16 Mb     105.16 Mb        161927  
                                        cudaMemcpyAsync         4.70%       17.673s         4.70%       17.673s     108.517us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162859  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       5.290ms         0.21%       5.290ms       2.645ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.07%     259.189ms         0.07%     259.189ms       1.593us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162700  
                                        aten::unsqueeze         0.00%      58.000us         0.00%      65.000us      65.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.22%     842.919ms         0.42%        1.587s       9.832us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                                 detach         0.20%     744.564ms         0.20%     744.564ms       4.612us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                            aten::clone         0.00%      65.000us         0.00%       3.279ms       1.639ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.45%        1.693s         1.61%        6.052s       6.052ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      28.797ms         0.01%      48.164ms      48.164us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.30%       31.208s         8.30%       31.208s      14.385us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2169405  
                                              aten::mul         0.03%      95.761ms         0.04%     141.493ms      47.196us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.10 Gb      37.10 Gb          2998  
                                              aten::add         0.05%     180.825ms         0.07%     270.260ms      45.051us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      77.03 Gb      77.03 Gb          5999  
                                 aten::reflection_pad2d         0.19%     711.351ms         0.47%        1.762s      67.698us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.96 Gb           0 b         26026  
                                           aten::conv2d         0.16%     611.303ms         2.92%       10.974s     154.412us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1080.96 Gb           0 b         71071  
                                      aten::convolution         0.38%        1.422s         2.75%       10.363s     145.811us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1080.96 Gb           0 b         71071  
                                     aten::_convolution         0.36%        1.367s         2.38%        8.941s     125.803us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1080.96 Gb           0 b         71071  
                                aten::cudnn_convolution         0.63%        2.353s         1.25%        4.687s     114.198us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     676.15 Gb     669.05 Gb         41041  
                                        cudaEventRecord         0.11%     424.330ms         0.11%     424.330ms       2.328us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        182293  
                                        cudaBindTexture         0.11%     398.800ms         0.11%     398.800ms       4.468us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         89247  
                                      cudaUnbindTexture         0.03%      96.606ms         0.03%      96.606ms       1.082us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         89247  
                                          aten::reshape         0.05%     187.232ms         0.07%     265.512ms      10.202us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      78.280ms         0.02%      78.280ms       3.008us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.19%        8.228s         4.26%       16.008s      30.381us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        526899  
                                       aten::batch_norm         0.07%     246.434ms         1.42%        5.341s     177.852us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.08%     297.411ms         1.35%        5.094s     169.646us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.52%        1.969s         1.28%        4.797s     159.742us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                       aten::empty_like         0.13%     507.088ms         0.48%        1.815s      32.212us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1187.12 Gb           0 b         56344  
                                      aten::leaky_relu_         0.15%     568.848ms         0.25%     949.012ms      37.923us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.01%      37.186ms         0.01%      37.186ms     572.092us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            65  
                               cudaEventCreateWithFlags         0.00%     461.000us         0.00%     461.000us       3.546us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           130  
                                   cudaEventSynchronize         0.12%     460.780ms         0.12%     460.780ms       1.431ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           322  
                                   cudaEventElapsedTime         0.00%       1.847ms         0.00%       1.847ms       5.736us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           322  
                                        cudaEventCreate         0.00%     163.000us         0.00%     163.000us       3.791us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            43  
                                    cudaStreamWaitEvent         0.00%     741.000us         0.00%     741.000us       0.793us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           935  
                                       cudaEventDestroy         0.00%     288.000us         0.00%     288.000us       1.665us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           173  
                                               cudaFree         0.05%     170.132ms         0.05%     170.132ms       7.397ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            23  
                                aten::_conv_depthwise2d         0.16%     610.092ms         0.49%        1.827s      60.852us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     404.81 Gb           0 b         30030  
                                             cudaMalloc         0.09%     354.395ms         0.09%     354.395ms      10.423ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            34  
                              aten::upsample_bilinear2d         0.06%     226.619ms         0.08%     307.235ms      61.386us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      46.643ms         0.02%      67.720ms      67.652us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       2.898ms         0.00%       2.898ms       2.898us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      45.979ms         0.06%     209.803ms     209.803us       0.000us         0.00%     133.000us       0.133us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.02%      90.658ms         0.03%     125.842ms     125.842us     133.000us         0.01%     133.000us       0.133us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.30%        1.128s         0.30%        1.128s      24.484us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         46088  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.026ms         0.08%       2.026ms       0.168us           0 b           0 b           0 b           0 b         12042  
                                        aten::ones_like         0.00%      12.453ms         0.02%      68.992ms      68.992us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      35.622ms         0.08%     313.916ms     313.916us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      24.759ms         0.07%     278.294ms     278.294us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.02%      68.831ms         0.08%     310.108ms     155.054us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     321.530ms         0.63%        2.385s      94.235us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.36 Gb           0 b         25314  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      34.523ms         0.04%     144.495ms     144.495us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      19.685ms         0.03%     109.972ms     109.972us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      59.967ms         0.02%      90.287ms      90.287us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.73%        2.752s         6.13%       23.075s     325.001us       0.000us         0.00%       1.893ms       0.027us           0 b           0 b   -1142.36 Gb   -2393.21 Gb         71000  
                                   ConvolutionBackward0         0.36%        1.339s         5.40%       20.323s     286.246us       0.000us         0.00%       1.893ms       0.027us           0 b           0 b    1250.86 Gb           0 b         71000  
                             aten::convolution_backward         1.96%        7.368s         5.05%       18.984s     267.382us       1.370ms         0.06%       1.893ms       0.027us           0 b           0 b    1250.86 Gb     774.99 Gb         71000  
                                              aten::sum         0.44%        1.673s         0.60%        2.276s      87.526us     523.000us         0.02%     523.000us       0.020us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.21%        4.560s         3.19%       12.015s      76.530us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      -1.85 Gb      -1.85 Gb        157000  
                        torch::autograd::AccumulateGrad         0.44%        1.650s         1.98%        7.455s      47.487us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       1.89 Mb           0 b        157000  
                                aten::new_empty_strided         0.00%       5.519ms         0.00%      12.492ms      79.567us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       1.89 Mb           0 b           157  
autograd::engine::evaluate_function: ReflectionPad2D...         0.25%     948.785ms         1.15%        4.331s     180.441us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -215.56 Gb    -848.84 Gb         24000  
                               ReflectionPad2DBackward0         0.07%     272.997ms         0.85%        3.197s     133.212us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.43 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.12%     467.232ms         0.78%        2.924s     121.837us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.43 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.26%     968.827ms         0.75%        2.808s     112.321us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -591.48 Gb   -1014.71 Gb         25000  
                                     LeakyReluBackward1         0.10%     370.390ms         0.49%        1.839s      73.568us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.23 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.26%     974.460ms         0.39%        1.469s      58.753us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.23 Gb     423.23 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.50%        1.880s         1.99%        7.468s     248.919us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -591.46 Gb   -1188.14 Gb         30000  
                                CudnnBatchNormBackward0         0.13%     503.107ms         1.49%        5.588s     186.259us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.68 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.50%        1.883s         1.35%        5.085s     169.489us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.68 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      71.990ms         0.10%     373.750ms      74.750us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      74.463ms         0.08%     301.760ms      60.352us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      71.140ms         0.18%     692.755ms     138.551us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      50.880ms         0.17%     621.615ms     124.323us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.07%     276.693ms         0.15%     570.735ms     114.147us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb      42.60 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.475s        99.71%        2.475s      15.211us           0 b           0 b           0 b           0 b        162696  
                                             aten::item         0.00%      17.809ms         0.03%     105.190ms      52.595us       0.000us         0.00%       1.373ms       0.686us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      24.874ms         0.02%      87.381ms      43.691us       1.373ms         0.06%       1.373ms       0.686us           0 b           0 b           0 b           0 b          2000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 376.172s
Self CUDA time total: 2.482s
