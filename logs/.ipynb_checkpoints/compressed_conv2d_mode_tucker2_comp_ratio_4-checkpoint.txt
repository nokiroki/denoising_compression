-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      25.492ms         0.02%      61.266ms      30.602us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.29%        8.314s         2.29%        8.328s      15.040us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1846.29 Gb    1846.29 Gb        553728  
                                            aten::zero_         0.46%        1.665s         1.48%        5.358s      30.765us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        174144  
                                      model_performance        53.40%      193.839s        85.88%      311.730s      311.730s       0.000us         0.00%        2.697s        2.697s      -2.21 Mb     -16.68 Gb       1.88 Mb   -2264.27 Gb             1  
                                            aten::stack         0.00%     452.000us         0.05%     187.974ms      15.665ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      86.608ms         0.18%     666.973ms     132.943us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.09%     337.763ms         0.16%     580.365ms     115.680us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.15%     558.011ms         0.15%     560.686ms      18.062us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     829.00 Gb     829.00 Gb         31043  
                                           aten::narrow         0.02%      79.033ms         0.06%     228.739ms      22.733us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     121.785ms         0.04%     149.733ms      14.880us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.04%     128.382ms         0.04%     128.382ms       3.462us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.07%     242.198ms         0.07%     242.198ms       4.034us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     335.000us         0.02%      77.259ms       6.438ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     215.000us         0.00%       1.202ms     100.167us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.46%        1.659s         1.05%        3.797s      21.927us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        173155  
                                           aten::select         0.00%     378.000us         0.00%     447.000us      18.625us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.57%        2.083s         4.55%       16.516s     113.121us        2.694s        99.82%        2.694s      18.454us           0 b           0 b           0 b           0 b        146004  
                                               aten::to         0.22%     810.415ms         5.98%       21.715s     148.901us       0.000us         0.00%        2.694s      18.473us      16.51 Gb           0 b      35.00 Mb           0 b        145836  
                aten::_has_compatible_shallow_copy_type         0.00%     208.000us         0.00%     208.000us       0.732us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           284  
                                         aten::uniform_         0.01%      50.028ms         0.01%      50.028ms      50.028ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.16%        4.201s         2.18%        7.902s      27.824us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        284001  
                                         aten::_to_copy         0.56%        2.018s         5.76%       20.905s     143.572us       0.000us         0.00%        2.694s      18.502us      16.51 Gb           0 b      35.00 Mb           0 b        145604  
                                    aten::empty_strided         0.71%        2.577s         0.71%        2.577s      17.528us       0.000us         0.00%       0.000us       0.000us      16.51 Gb      16.51 Gb     105.13 Mb     105.13 Mb        147032  
                                        cudaMemcpyAsync         3.93%       14.256s         3.93%       14.256s      96.337us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147979  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.328ms         0.16%       4.328ms       2.164ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.07%     243.992ms         0.07%     243.992ms       1.650us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147835  
                                        aten::unsqueeze         0.00%     493.000us         0.00%     498.000us     498.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.21%     745.722ms         0.39%        1.414s       9.643us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                                 detach         0.18%     668.018ms         0.18%     668.018ms       4.557us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                            aten::clone         0.00%      44.000us         0.00%     503.000us     251.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.43%        1.550s         1.51%        5.477s       5.477ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      30.501ms         0.01%      49.723ms      49.723us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.13%       29.505s         8.13%       29.505s      14.541us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2029063  
                                              aten::mul         0.03%      99.558ms         0.04%     144.664ms      48.254us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.10 Gb      37.10 Gb          2998  
                                              aten::add         0.05%     180.681ms         0.07%     271.300ms      45.224us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      77.11 Gb      77.11 Gb          5999  
                                 aten::reflection_pad2d         0.20%     712.818ms         0.49%        1.763s      67.744us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     657.12 Gb           0 b         26026  
                                           aten::conv2d         0.14%     505.874ms         3.70%       13.421s     239.413us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     600.14 Gb           0 b         56056  
                                      aten::convolution         0.32%        1.163s         3.56%       12.915s     230.388us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     600.14 Gb           0 b         56056  
                                     aten::_convolution         0.29%        1.059s         3.24%       11.752s     209.642us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     600.14 Gb           0 b         56056  
                                aten::cudnn_convolution         1.82%        6.601s         2.65%        9.628s     171.757us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     600.14 Gb     590.75 Gb         56056  
                                        cudaEventRecord         0.15%     528.386ms         0.15%     528.386ms       2.320us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        227756  
                                        cudaBindTexture         0.14%     509.219ms         0.14%     509.219ms       4.377us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        116330  
                                      cudaUnbindTexture         0.03%     122.570ms         0.03%     122.570ms       1.054us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        116330  
                                          aten::reshape         0.05%     184.815ms         0.07%     261.479ms      10.047us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      76.664ms         0.02%      76.664ms       2.946us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.09%        7.598s         4.08%       14.804s      30.720us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        481914  
                                       aten::batch_norm         0.07%     245.695ms         1.49%        5.419s     180.448us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.15 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.08%     292.686ms         1.43%        5.173s     172.267us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.15 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.58%        2.092s         1.34%        4.880s     162.520us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.15 Gb           0 b         30030  
                                       aten::empty_like         0.15%     549.641ms         0.50%        1.816s      32.254us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1189.51 Gb           0 b         56314  
                                      aten::leaky_relu_         0.16%     581.727ms         0.26%     959.064ms      38.324us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.01%      34.274ms         0.01%      34.274ms     398.535us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            86  
                               cudaEventCreateWithFlags         0.01%      45.448ms         0.01%      45.448ms     264.233us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           172  
                                   cudaEventSynchronize         0.17%     604.817ms         0.17%     604.817ms       1.332ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           454  
                                   cudaEventElapsedTime         0.00%       2.130ms         0.00%       2.130ms       4.692us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           454  
                                        cudaEventCreate         0.00%       9.944ms         0.00%       9.944ms     174.456us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            57  
                                    cudaStreamWaitEvent         0.00%       1.433ms         0.00%       1.433ms       0.484us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2960  
                                       cudaEventDestroy         0.00%     265.000us         0.00%     265.000us       1.157us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           229  
                                               cudaFree         0.06%     212.413ms         0.06%     212.413ms       4.828ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            44  
                                             cudaMalloc         0.12%     449.518ms         0.12%     449.518ms       7.619ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            59  
                              aten::upsample_bilinear2d         0.07%     250.333ms         0.09%     332.075ms      66.349us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      45.561ms         0.02%      66.121ms      66.055us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       2.747ms         0.00%       2.747ms       2.747us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      46.671ms         0.06%     212.718ms     212.718us       0.000us         0.00%     179.000us       0.179us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.03%      93.172ms         0.04%     127.691ms     127.691us     179.000us         0.01%     179.000us       0.179us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.32%        1.160s         0.32%        1.160s      21.436us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         54116  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.816ms         0.10%       2.816ms       0.216us           0 b           0 b           0 b           0 b         13058  
                                        aten::ones_like         0.00%      12.459ms         0.02%      68.607ms      68.607us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      52.733ms         0.15%     529.179ms     529.179us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      39.218ms         0.13%     476.446ms     476.446us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.05%     178.317ms         0.16%     569.567ms     284.784us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.10%     355.082ms         0.68%        2.458s      97.229us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.39 Gb           0 b         25284  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      35.950ms         0.04%     152.031ms     152.031us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      20.147ms         0.03%     116.081ms     116.081us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      64.850ms         0.03%      95.934ms      95.934us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.62%        2.237s         6.65%       24.131s     430.910us       0.000us         0.00%       2.637ms       0.047us           0 b           0 b    -660.16 Gb   -1433.20 Gb         56000  
                                   ConvolutionBackward0         0.29%        1.040s         6.03%       21.894s     390.960us       0.000us         0.00%       2.637ms       0.047us           0 b           0 b     773.04 Gb           0 b         56000  
                             aten::convolution_backward         2.52%        9.152s         5.74%       20.854s     372.395us       1.997ms         0.07%       2.637ms       0.047us           0 b           0 b     773.04 Gb     725.02 Gb         56000  
                                              aten::sum         0.49%        1.770s         0.66%        2.402s      92.377us     640.000us         0.02%     640.000us       0.025us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.04%        3.784s         2.97%       10.765s      75.809us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      -1.84 Gb      -1.84 Gb        142000  
                        torch::autograd::AccumulateGrad         0.44%        1.592s         1.92%        6.981s      49.164us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       1.88 Mb           0 b        142000  
                                aten::new_empty_strided         0.02%      58.980ms         0.03%     105.880ms     745.634us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       1.88 Mb           0 b           142  
autograd::engine::evaluate_function: ReflectionPad2D...         0.24%     867.029ms         1.19%        4.307s     179.447us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -216.91 Gb    -852.30 Gb         24000  
                               ReflectionPad2DBackward0         0.08%     297.935ms         0.90%        3.256s     135.687us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     592.46 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.13%     485.655ms         0.82%        2.959s     123.273us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     592.46 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.38%        1.365s         0.87%        3.153s     126.112us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -591.30 Gb   -1014.75 Gb         25000  
                                     LeakyReluBackward1         0.09%     339.004ms         0.49%        1.788s      71.507us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.44 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.26%     946.086ms         0.40%        1.449s      57.947us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.44 Gb     423.44 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.49%        1.793s         1.95%        7.092s     236.406us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -593.17 Gb   -1189.59 Gb         30000  
                                CudnnBatchNormBackward0         0.15%     532.794ms         1.46%        5.299s     176.642us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.42 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.52%        1.888s         1.31%        4.766s     158.883us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.42 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      75.825ms         0.10%     377.099ms      75.420us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      75.160ms         0.08%     301.274ms      60.255us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      77.239ms         0.20%     722.860ms     144.572us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.11 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      49.991ms         0.18%     645.621ms     129.124us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.11 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.08%     295.392ms         0.16%     595.630ms     119.126us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.11 Gb      42.11 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.692s        99.74%        2.692s      18.211us           0 b           0 b           0 b           0 b        147832  
                                             aten::item         0.01%      21.339ms         0.03%     112.149ms      56.075us       0.000us         0.00%       2.112ms       1.056us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      24.956ms         0.03%      90.810ms      45.405us       2.112ms         0.08%       2.112ms       1.056us           0 b           0 b           0 b           0 b          2000  
                               Optimizer.step#Adam.step         8.16%       29.636s        17.82%       64.679s      64.679ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb       3.76 Mb      -3.67 Gb          1000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 362.998s
Self CUDA time total: 2.699s
