-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      29.493ms         0.02%      68.513ms      34.222us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         3.01%       11.382s         3.01%       11.397s      19.523us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1803.59 Gb    1803.59 Gb        583773  
                                            aten::zero_         0.51%        1.925s         1.54%        5.845s      30.898us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        189159  
                                      model_performance        51.91%      196.628s        85.79%      324.950s      324.950s       0.000us         0.00%        2.844s        2.844s    -134.55 Kb     -15.26 Gb     425.00 Kb   -2108.43 Gb             1  
                                            aten::stack         0.00%     375.000us         0.05%     203.892ms      16.991ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      81.729ms         0.18%     674.218ms     134.387us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     172.86 Gb           0 b          5017  
                                             aten::_cat         0.09%     359.658ms         0.16%     592.489ms     118.096us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     172.86 Gb           0 b          5017  
                                          aten::resize_         0.74%        2.812s         0.75%        2.835s      23.413us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     851.46 Gb     851.46 Gb        121073  
                                           aten::narrow         0.02%      81.070ms         0.06%     228.097ms      22.669us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     119.539ms         0.04%     147.052ms      14.613us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     120.762ms         0.03%     120.762ms       3.256us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     243.624ms         0.06%     243.624ms       4.058us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     313.000us         0.02%      80.262ms       6.689ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     145.000us         0.00%     931.000us      77.583us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.46%        1.748s         1.06%        4.028s      21.404us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        188170  
                                           aten::select         0.00%     277.000us         0.00%     329.000us      13.708us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.58%        2.216s         4.44%       16.814s     104.508us        2.842s        99.63%        2.842s      17.666us           0 b           0 b           0 b           0 b        160884  
                                               aten::to         0.27%        1.034s         6.06%       22.947s     142.795us       0.000us         0.00%        2.842s      17.685us      15.08 Gb           0 b      35.00 Mb           0 b        160701  
                aten::_has_compatible_shallow_copy_type         0.00%     219.000us         0.00%     219.000us       0.697us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           314  
                                         aten::uniform_         0.01%      48.756ms         0.01%      48.756ms      48.756ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.20%        4.540s         2.25%        8.537s      27.187us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        314001  
                                         aten::_to_copy         0.67%        2.530s         5.79%       21.913s     136.572us       0.000us         0.00%        2.842s      17.712us      15.08 Gb           0 b      35.00 Mb           0 b        160454  
                                    aten::empty_strided         0.73%        2.761s         0.73%        2.761s      17.052us       0.000us         0.00%       0.000us       0.000us      15.08 Gb      15.08 Gb     100.73 Mb     100.73 Mb        161927  
                                        cudaMemcpyAsync         3.81%       14.430s         3.81%       14.430s      88.607us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162859  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.744ms         0.17%       4.744ms       2.372ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.06%     240.555ms         0.06%     240.555ms       1.479us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162700  
                                        aten::unsqueeze         0.00%      51.000us         0.00%      56.000us      56.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.29%        1.092s         0.50%        1.907s      11.810us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                                 detach         0.22%     814.395ms         0.22%     814.395ms       5.044us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                            aten::clone         0.00%      37.000us         0.00%     542.000us     271.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.48%        1.832s         1.66%        6.300s       6.300ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      27.149ms         0.01%      46.097ms      46.097us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.27%       31.310s         8.27%       31.310s      14.461us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2165226  
                                              aten::mul         0.03%     102.242ms         0.04%     148.317ms      49.472us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      38.08 Gb      38.08 Gb          2998  
                                             cudaMalloc         0.03%      96.849ms         0.03%      96.849ms       2.306ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            42  
                                              aten::add         0.05%     179.930ms         0.07%     268.751ms      44.799us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.78 Gb      76.78 Gb          5999  
                                 aten::reflection_pad2d         0.19%     737.052ms         0.48%        1.813s      69.675us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     656.92 Gb           0 b         26026  
                                           aten::conv2d         0.19%     705.549ms         2.98%       11.280s     158.713us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     441.44 Gb           0 b         71071  
                                      aten::convolution         0.45%        1.698s         2.79%       10.574s     148.786us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     441.44 Gb           0 b         71071  
                                     aten::_convolution         0.43%        1.634s         2.34%        8.876s     124.888us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     441.44 Gb           0 b         71071  
                                aten::cudnn_convolution         0.65%        2.464s         1.11%        4.217s     102.760us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     432.22 Gb     427.27 Gb         41041  
                                        cudaEventRecord         0.11%     427.126ms         0.11%     427.126ms       2.359us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        181071  
                                        cudaBindTexture         0.11%     424.349ms         0.11%     424.349ms       4.662us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         91031  
                                      cudaUnbindTexture         0.03%     120.981ms         0.03%     120.981ms       1.329us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         91031  
                                          aten::reshape         0.06%     217.784ms         0.08%     297.738ms      11.440us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      79.954ms         0.02%      79.954ms       3.072us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.14%        8.089s         4.18%       15.829s      30.042us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        526899  
                                       aten::batch_norm         0.08%     288.377ms         1.76%        6.677s     222.348us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.77 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.10%     362.231ms         1.69%        6.389s     212.745us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.77 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.55%        2.078s         1.59%        6.027s     200.683us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.77 Gb           0 b         30030  
                                       aten::empty_like         0.14%     533.627ms         0.77%        2.924s      51.903us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1189.84 Gb           0 b         56344  
                                      aten::leaky_relu_         0.15%     578.422ms         0.25%     956.284ms      38.213us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                aten::_conv_depthwise2d         0.18%     669.821ms         0.51%        1.941s      64.642us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       9.22 Gb           0 b         30030  
                              aten::upsample_bilinear2d         0.06%     233.051ms         0.08%     315.177ms      62.972us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      41.943ms         0.02%      63.093ms      63.030us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.42 Gb       3.42 Gb          1001  
                                aten::broadcast_tensors         0.00%       8.449ms         0.00%       8.449ms       8.449us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      46.539ms         0.06%     216.792ms     216.792us       0.000us         0.00%     129.000us       0.129us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.03%      95.087ms         0.03%     130.941ms     130.941us     129.000us         0.00%     129.000us       0.129us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.36%        1.374s         0.36%        1.374s      29.878us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         46000  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       8.501ms         0.30%       8.501ms       0.202us           0 b           0 b           0 b           0 b         42000  
                                        aten::ones_like         0.00%      13.363ms         0.02%      70.502ms      70.502us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      40.191ms         0.10%     386.115ms     386.115us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      34.511ms         0.09%     345.924ms     345.924us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.02%      82.453ms         0.10%     368.821ms     184.411us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     328.462ms         0.64%        2.412s      95.301us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.10 Gb           0 b         25314  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      34.282ms         0.04%     163.697ms     163.697us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      -1.00 Mb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      19.396ms         0.03%     129.415ms     129.415us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.01%      55.981ms         0.03%     110.019ms     110.019us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.76%        2.879s         6.99%       26.464s     372.735us       0.000us         0.00%       8.372ms       0.118us           0 b           0 b    -501.64 Gb   -1116.05 Gb         71000  
                                   ConvolutionBackward0         0.37%        1.407s         6.23%       23.586s     332.192us       0.000us         0.00%       8.372ms       0.118us           0 b           0 b     614.40 Gb           0 b         71000  
                             aten::convolution_backward         1.98%        7.494s         5.86%       22.179s     312.375us       7.759ms         0.27%       8.372ms       0.118us           0 b           0 b     614.40 Gb     594.11 Gb         71000  
                                              aten::sum         0.45%        1.692s         0.61%        2.292s      88.161us     613.000us         0.02%     613.000us       0.024us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.12%        4.237s         3.08%       11.673s      74.347us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -414.62 Mb    -415.04 Mb        157000  
                        torch::autograd::AccumulateGrad         0.45%        1.688s         1.96%        7.435s      47.360us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     425.00 Kb           0 b        157000  
                                aten::new_empty_strided         0.00%       3.476ms         0.01%      23.375ms     148.885us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     425.00 Kb           0 b           157  
autograd::engine::evaluate_function: ReflectionPad2D...         0.23%     873.727ms         1.12%        4.239s     176.611us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -218.60 Gb    -853.37 Gb         24000  
                               ReflectionPad2DBackward0         0.07%     272.582ms         0.84%        3.181s     132.557us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     592.17 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.12%     457.846ms         0.77%        2.909s     121.200us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     592.17 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.23%     880.832ms         0.70%        2.646s     105.826us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -589.98 Gb   -1015.35 Gb         25000  
                                     LeakyReluBackward1         0.09%     331.879ms         0.47%        1.765s      70.593us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     425.37 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.25%     929.550ms         0.38%        1.433s      57.318us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     425.37 Gb     425.37 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.49%        1.852s         1.88%        7.124s     237.479us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -595.12 Gb   -1193.14 Gb         30000  
                                CudnnBatchNormBackward0         0.14%     527.001ms         1.39%        5.272s     175.743us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     598.02 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.49%        1.875s         1.25%        4.745s     158.176us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     598.02 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      76.515ms         0.10%     378.385ms      75.677us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      75.559ms         0.08%     301.870ms      60.374us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      71.839ms         0.18%     699.357ms     139.871us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      51.705ms         0.17%     627.518ms     125.504us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.07%     277.617ms         0.15%     575.813ms     115.163us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb      42.60 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.840s        99.54%        2.840s      17.453us           0 b           0 b           0 b           0 b        162696  
                                             aten::item         0.01%      22.968ms         0.03%     119.336ms      59.668us       0.000us         0.00%       2.100ms       1.050us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      24.748ms         0.03%      96.368ms      48.184us       2.100ms         0.07%       2.100ms       1.050us           0 b           0 b           0 b           0 b          2000  
                               Optimizer.step#Adam.step         9.24%       35.011s        19.38%       73.399s      73.399ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb     850.00 Kb    -830.08 Mb          1000  
                                         aten::addcmul_         0.60%        2.280s         1.13%        4.267s      27.175us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        157000  
                                             aten::sqrt         1.14%        4.318s         1.65%        6.246s      39.786us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     415.04 Mb     415.04 Mb        157000  
                                              aten::div         1.17%        4.424s         1.69%        6.402s      40.780us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     415.04 Mb     415.04 Mb        157000  
                                         aten::addcdiv_         0.64%        2.435s         1.19%        4.514s      28.751us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        157000  
                                             aten::set_         0.00%       4.815ms         0.00%       4.815ms       9.747us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           494  
                                  cudaDeviceSynchronize         0.00%      10.000us         0.00%      10.000us      10.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 378.778s
Self CUDA time total: 2.853s
