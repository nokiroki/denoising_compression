-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      30.206ms         0.02%      67.732ms      33.832us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.41%        8.713s         2.41%        8.716s      15.741us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1810.15 Gb    1810.15 Gb        553728  
                                            aten::zero_         0.48%        1.723s         1.47%        5.323s      30.566us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        174144  
                                      model_performance        55.30%      199.663s        85.28%      307.916s      307.916s       0.000us         0.00%        2.528s        2.528s     134.54 Kb     -15.38 Gb     548.50 Kb   -2134.43 Gb             1  
                                            aten::stack         0.00%     503.000us         0.05%     192.064ms      16.005ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      85.263ms         0.18%     655.074ms     130.571us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     172.86 Gb           0 b          5017  
                                             aten::_cat         0.09%     341.788ms         0.16%     569.811ms     113.576us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     172.86 Gb           0 b          5017  
                                          aten::resize_         0.16%     566.832ms         0.16%     571.629ms      18.414us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     829.36 Gb     829.36 Gb         31043  
                                           aten::narrow         0.02%      81.113ms         0.06%     232.825ms      23.139us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     123.853ms         0.04%     151.736ms      15.079us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     119.982ms         0.03%     119.982ms       3.235us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.07%     248.984ms         0.07%     248.984ms       4.147us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     304.000us         0.02%      77.422ms       6.452ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     151.000us         0.00%     980.000us      81.667us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.44%        1.606s         1.03%        3.704s      21.390us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        173155  
                                           aten::select         0.00%     366.000us         0.00%     425.000us      17.708us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.56%        2.010s         3.07%       11.096s      75.995us        2.526s        98.75%        2.526s      17.302us           0 b           0 b           0 b           0 b        146004  
                                               aten::to         0.26%     950.871ms         4.63%       16.717s     114.632us       0.000us         0.00%        2.526s      17.320us      15.21 Gb           0 b      35.00 Mb           0 b        145836  
                aten::_has_compatible_shallow_copy_type         0.00%     229.000us         0.00%     229.000us       0.806us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           284  
                                         aten::uniform_         0.02%      56.754ms         0.02%      56.754ms      56.754ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.11%        3.992s         2.11%        7.623s      26.842us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        284001  
                                         aten::_to_copy         0.63%        2.288s         4.37%       15.767s     108.284us       0.000us         0.00%        2.526s      17.348us      15.21 Gb           0 b      35.00 Mb           0 b        145604  
                                    aten::empty_strided         0.71%        2.563s         0.71%        2.563s      17.431us       0.000us         0.00%       0.000us       0.000us      15.21 Gb      15.21 Gb     101.10 Mb     101.10 Mb        147032  
                                        cudaMemcpyAsync         2.47%        8.935s         2.47%        8.935s      60.384us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147979  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.768ms         0.19%       4.768ms       2.384ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.06%     224.920ms         0.06%     224.920ms       1.521us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147835  
                                        aten::unsqueeze         0.00%      32.000us         0.00%      37.000us      37.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.26%     922.806ms         0.46%        1.650s      11.258us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                                 detach         0.20%     727.678ms         0.20%     727.678ms       4.964us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                            aten::clone         0.00%      34.000us         0.00%     308.000us     154.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.46%        1.658s         1.55%        5.612s       5.612ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      25.987ms         0.01%      44.918ms      44.918us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         7.98%       28.802s         7.98%       28.802s      14.371us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2004219  
                                              aten::mul         0.03%      97.088ms         0.04%     141.830ms      47.308us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.10 Gb      37.10 Gb          2998  
                                              aten::add         0.05%     176.958ms         0.07%     270.184ms      45.038us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.08 Gb      76.08 Gb          5999  
                                             cudaMalloc         0.01%      33.799ms         0.01%      33.799ms     824.366us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            41  
                                 aten::reflection_pad2d         0.20%     733.925ms         0.50%        1.800s      69.179us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     656.50 Gb           0 b         26026  
                                           aten::conv2d         0.16%     581.304ms         2.71%        9.780s     174.469us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb           0 b         56056  
                                      aten::convolution         0.38%        1.370s         2.55%        9.199s     164.099us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb           0 b         56056  
                                     aten::_convolution         0.35%        1.253s         2.17%        7.828s     139.654us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb           0 b         56056  
                                aten::cudnn_convolution         0.87%        3.158s         1.52%        5.506s      98.216us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     468.34 Gb     459.65 Gb         56056  
                                        cudaEventRecord         0.14%     516.158ms         0.14%     516.158ms       2.243us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        230086  
                                        cudaBindTexture         0.14%     510.421ms         0.14%     510.421ms       4.288us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        119038  
                                      cudaUnbindTexture         0.04%     132.412ms         0.04%     132.412ms       1.112us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        119038  
                                          aten::reshape         0.06%     216.629ms         0.08%     295.388ms      11.350us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      78.759ms         0.02%      78.759ms       3.026us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.04%        7.364s         3.99%       14.402s      29.886us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        481914  
                                       aten::batch_norm         0.08%     290.324ms         1.53%        5.535s     184.310us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.77 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.09%     342.676ms         1.45%        5.244s     174.642us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.77 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.56%        2.031s         1.36%        4.902s     163.231us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.77 Gb           0 b         30030  
                                       aten::empty_like         0.15%     547.182ms         0.59%        2.121s      37.658us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1187.39 Gb           0 b         56314  
                                      aten::leaky_relu_         0.16%     577.641ms         0.26%     949.990ms      37.962us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                              aten::upsample_bilinear2d         0.06%     229.580ms         0.09%     309.934ms      61.925us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      39.991ms         0.02%      60.155ms      60.095us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.91 Gb       3.91 Gb          1001  
                                aten::broadcast_tensors         0.00%       3.020ms         0.00%       3.020ms       3.020us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      45.755ms         0.06%     221.894ms     221.894us       0.000us         0.00%     184.000us       0.184us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.03%     102.702ms         0.04%     138.153ms     138.153us     184.000us         0.01%     184.000us       0.184us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.39%        1.395s         0.39%        1.395s      23.637us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         59000  
                                        aten::ones_like         0.00%      13.455ms         0.02%      69.250ms      69.250us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      30.015ms         1.17%      30.015ms       0.625us           0 b           0 b           0 b           0 b         48000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      43.343ms         0.12%     417.084ms     417.084us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      31.501ms         0.10%     373.741ms     373.741us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.04%     129.383ms         0.12%     442.244ms     221.122us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     335.207ms         0.74%        2.674s     105.753us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     592.65 Gb           0 b         25284  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      38.932ms         0.04%     149.299ms     149.299us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -959.50 Kb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      26.250ms         0.03%     110.367ms     110.367us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      54.952ms         0.02%      84.117ms      84.117us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.65%        2.329s         6.12%       22.100s     394.647us       0.000us         0.00%      29.831ms       0.533us           0 b           0 b    -530.14 Gb   -1169.06 Gb         56000  
                                   ConvolutionBackward0         0.32%        1.148s         5.48%       19.771s     353.057us       0.000us         0.00%      29.831ms       0.533us           0 b           0 b     638.91 Gb           0 b         56000  
                             aten::convolution_backward         2.16%        7.810s         5.16%       18.623s     332.549us      28.934ms         1.13%      29.831ms       0.533us           0 b           0 b     638.91 Gb     622.89 Gb         56000  
                                              aten::sum         0.47%        1.714s         0.71%        2.561s      98.518us     897.000us         0.04%     897.000us       0.035us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.59%        5.728s         3.50%       12.626s      88.916us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -535.11 Mb    -535.64 Mb        142000  
                        torch::autograd::AccumulateGrad         0.45%        1.614s         1.91%        6.898s      48.577us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     548.50 Kb           0 b        142000  
                                aten::new_empty_strided         0.01%      28.590ms         0.02%      57.573ms     405.444us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     548.50 Kb           0 b           142  
autograd::engine::evaluate_function: ReflectionPad2D...         0.24%     877.042ms         1.26%        4.545s     189.360us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -218.38 Gb    -850.00 Gb         24000  
                               ReflectionPad2DBackward0         0.08%     287.235ms         0.96%        3.482s     145.078us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.71 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.13%     462.338ms         0.88%        3.195s     133.110us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     589.71 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.79%        2.846s         1.30%        4.703s     188.111us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -590.22 Gb   -1012.21 Gb         25000  
                                     LeakyReluBackward1         0.09%     339.349ms         0.51%        1.857s      74.261us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     421.98 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.28%        1.020s         0.42%        1.517s      60.687us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     421.98 Gb     421.98 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.53%        1.900s         2.07%        7.466s     248.868us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -593.81 Gb   -1188.91 Gb         30000  
                                CudnnBatchNormBackward0         0.15%     555.185ms         1.54%        5.566s     185.529us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.10 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.53%        1.921s         1.39%        5.011s     167.023us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.10 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      74.776ms         0.11%     381.778ms      76.356us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      76.576ms         0.09%     307.002ms      61.400us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      72.788ms         0.20%     727.125ms     145.425us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.51 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.02%      54.991ms         0.18%     654.337ms     130.867us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.51 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.08%     300.379ms         0.17%     599.346ms     119.869us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.51 Gb      42.51 Gb          5000  
                                    cudaStreamWaitEvent         0.00%       4.833ms         0.00%       4.833ms       1.208us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.523s        98.64%        2.523s      17.070us           0 b           0 b           0 b           0 b        147831  
                                             aten::item         0.01%      20.755ms         0.03%     116.794ms      58.397us       0.000us         0.00%       2.048ms       1.024us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      22.204ms         0.03%      96.039ms      48.020us       2.048ms         0.08%       2.048ms       1.024us           0 b           0 b           0 b           0 b          2000  
                               Optimizer.step#Adam.step         7.69%       27.774s        17.51%       63.215s      63.215ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb       1.07 Mb      -1.05 Gb          1000  
                                         aten::addcmul_         0.56%        2.029s         1.06%        3.814s      26.856us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        142000  
                                             aten::sqrt         1.38%        4.975s         1.86%        6.733s      47.415us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     535.64 Mb     535.64 Mb        142000  
                                              aten::div         1.09%        3.946s         1.59%        5.749s      40.487us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     535.64 Mb     535.64 Mb        142000  
                                         aten::addcdiv_         0.60%        2.162s         1.12%        4.034s      28.406us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        142000  
                                             aten::set_         0.00%       4.235ms         0.00%       4.235ms       9.127us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           464  
                                  cudaDeviceSynchronize         0.00%      11.000us         0.00%      11.000us      11.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 361.062s
Self CUDA time total: 2.558s
