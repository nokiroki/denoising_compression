-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      28.417ms         0.02%      66.727ms      33.330us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.07%        7.942s         2.07%        7.950s      13.618us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1803.67 Gb    1803.67 Gb        583773  
                                            aten::zero_         0.49%        1.882s         1.55%        5.925s      31.321us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        189159  
                                      model_performance        52.42%      200.889s        85.90%      329.215s      329.215s       0.000us         0.00%        2.515s        2.515s      -5.61 Kb     -15.42 Gb    -308.00 Kb   -2173.74 Gb             1  
                                            aten::stack         0.00%     476.000us         0.06%     214.362ms      17.863ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      86.085ms         0.18%     685.451ms     136.626us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.10%     368.841ms         0.16%     599.366ms     119.467us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.61%        2.345s         0.62%        2.357s      19.469us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     942.43 Gb     942.43 Gb        121073  
                                           aten::narrow         0.02%      84.574ms         0.06%     241.527ms      24.004us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     129.233ms         0.04%     156.973ms      15.599us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     125.000ms         0.03%     125.000ms       3.370us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     246.446ms         0.06%     246.446ms       4.105us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     384.000us         0.02%      82.737ms       6.895ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     176.000us         0.00%       1.132ms      94.333us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.47%        1.820s         1.08%        4.153s      22.069us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        188170  
                                           aten::select         0.00%     305.000us         0.00%     361.000us      15.042us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.60%        2.284s         4.41%       16.894s     105.005us        2.513s        99.81%        2.513s      15.621us           0 b           0 b           0 b           0 b        160884  
                                               aten::to         0.26%     992.618ms         7.01%       26.847s     167.063us       0.000us         0.00%        2.513s      15.637us      15.25 Gb           0 b      35.00 Mb           0 b        160701  
                aten::_has_compatible_shallow_copy_type         0.00%     214.000us         0.00%     214.000us       0.682us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           314  
                                         aten::uniform_         0.01%      53.029ms         0.01%      53.029ms      53.029ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.22%        4.681s         2.31%        8.870s      28.247us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        314001  
                                         aten::_to_copy         0.65%        2.487s         6.75%       25.855s     161.134us       0.000us         0.00%        2.513s      15.661us      15.25 Gb           0 b      35.00 Mb           0 b        160454  
                                    aten::empty_strided         1.74%        6.654s         1.74%        6.654s      41.095us       0.000us         0.00%       0.000us       0.000us      15.25 Gb      15.25 Gb     101.23 Mb     101.23 Mb        161927  
                                        cudaMemcpyAsync         3.76%       14.424s         3.76%       14.424s      88.565us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162859  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.529ms         0.18%       4.529ms       2.264ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.07%     255.120ms         0.07%     255.120ms       1.568us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162700  
                                        aten::unsqueeze         0.00%      66.000us         0.00%      71.000us      71.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.26%     994.992ms         0.47%        1.798s      11.138us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                                 detach         0.21%     803.260ms         0.21%     803.260ms       4.975us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                            aten::clone         0.00%      37.000us         0.00%     572.000us     286.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.47%        1.819s         1.65%        6.329s       6.329ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      27.821ms         0.01%      47.555ms      47.555us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.37%       32.058s         8.37%       32.058s      14.833us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2161261  
                                              aten::mul         0.03%      98.465ms         0.04%     144.959ms      48.352us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.10 Gb      37.10 Gb          2998  
                                              aten::add         0.05%     186.466ms         0.07%     276.252ms      46.050us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.41 Gb      76.41 Gb          5999  
                                 aten::reflection_pad2d         0.19%     741.666ms         0.47%        1.820s      69.916us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.86 Gb           0 b         26026  
                                           aten::conv2d         0.17%     670.217ms         2.87%       10.993s     154.673us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     511.22 Gb           0 b         71071  
                                      aten::convolution         0.42%        1.604s         2.69%       10.323s     145.242us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     511.22 Gb           0 b         71071  
                                     aten::_convolution         0.41%        1.556s         2.28%        8.719s     122.678us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     511.22 Gb           0 b         71071  
                                aten::cudnn_convolution         0.59%        2.262s         1.08%        4.152s     101.167us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     457.70 Gb     452.91 Gb         41041  
                                        cudaEventRecord         0.12%     441.854ms         0.12%     441.854ms       2.426us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        182106  
                                        cudaBindTexture         0.11%     439.315ms         0.11%     439.315ms       4.519us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         97215  
                                      cudaUnbindTexture         0.03%     105.908ms         0.03%     105.908ms       1.089us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         97215  
                                          aten::reshape         0.05%     208.592ms         0.08%     289.502ms      11.124us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      80.910ms         0.02%      80.910ms       3.109us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.17%        8.321s         4.23%       16.198s      30.741us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        526899  
                                       aten::batch_norm         0.07%     267.449ms         1.44%        5.537s     184.385us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.09%     335.689ms         1.38%        5.270s     175.479us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.54%        2.062s         1.29%        4.934s     164.300us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                       aten::empty_like         0.14%     541.466ms         0.48%        1.835s      32.569us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1188.12 Gb           0 b         56344  
                                      aten::leaky_relu_         0.16%     596.369ms         0.26%     980.969ms      39.200us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.01%      21.310ms         0.01%      21.310ms     402.075us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            53  
                               cudaEventCreateWithFlags         0.00%     302.000us         0.00%     302.000us       2.849us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           106  
                                   cudaEventSynchronize         0.06%     219.026ms         0.06%     219.026ms     814.223us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           269  
                                   cudaEventElapsedTime         0.00%       1.301ms         0.00%       1.301ms       4.836us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           269  
                                        cudaEventCreate         0.00%      87.000us         0.00%      87.000us       2.486us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            35  
                                    cudaStreamWaitEvent         0.00%     427.000us         0.00%     427.000us       0.541us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           790  
                                       cudaEventDestroy         0.00%     209.000us         0.00%     209.000us       1.482us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           141  
                                               cudaFree         0.01%      32.121ms         0.01%      32.121ms       1.190ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            27  
                                aten::_conv_depthwise2d         0.17%     648.446ms         0.50%        1.912s      63.679us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      53.52 Gb           0 b         30030  
                                             cudaMalloc         0.02%      85.538ms         0.02%      85.538ms       2.037ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            42  
                              aten::upsample_bilinear2d         0.06%     229.857ms         0.08%     312.469ms      62.431us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      43.737ms         0.02%      64.763ms      64.698us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       2.969ms         0.00%       2.969ms       2.969us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      47.506ms         0.06%     215.986ms     215.986us       0.000us         0.00%     167.000us       0.167us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.02%      94.810ms         0.03%     130.162ms     130.162us     167.000us         0.01%     167.000us       0.167us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.24%     916.198ms         0.24%     916.198ms      19.886us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         46072  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.650ms         0.11%       2.650ms       0.189us           0 b           0 b           0 b           0 b         14039  
                                        aten::ones_like         0.00%      12.938ms         0.02%      70.498ms      70.498us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      35.170ms         0.09%     336.576ms     336.576us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      24.356ms         0.08%     301.406ms     301.406us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.02%      70.041ms         0.09%     334.649ms     167.325us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     335.896ms         0.64%        2.435s      96.200us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     594.36 Gb           0 b         25314  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      34.415ms         0.04%     141.737ms     141.737us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      19.785ms         0.03%     107.322ms     107.322us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      57.865ms         0.02%      87.537ms      87.537us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         1.39%        5.339s         6.82%       26.131s     368.036us       0.000us         0.00%       2.483ms       0.035us           0 b           0 b    -572.44 Gb   -1254.30 Gb         71000  
                                   ConvolutionBackward0         0.37%        1.418s         5.43%       20.791s     292.833us       0.000us         0.00%       2.483ms       0.035us           0 b           0 b     681.86 Gb           0 b         71000  
                             aten::convolution_backward         1.97%        7.545s         5.06%       19.373s     272.854us       1.924ms         0.08%       2.483ms       0.035us           0 b           0 b     681.86 Gb     609.16 Gb         71000  
                                              aten::sum         0.50%        1.919s         0.66%        2.518s      96.832us     559.000us         0.02%     559.000us       0.021us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.11%        4.239s         3.05%       11.684s      74.419us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -580.47 Mb    -581.05 Mb        157000  
                        torch::autograd::AccumulateGrad         0.45%        1.721s         1.94%        7.445s      47.419us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.00 Kb           0 b        157000  
                                aten::new_empty_strided         0.00%       5.533ms         0.00%       9.897ms      63.038us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.00 Kb           0 b           157  
autograd::engine::evaluate_function: ReflectionPad2D...         0.23%     891.147ms         1.13%        4.332s     180.508us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -216.73 Gb    -850.39 Gb         24000  
                               ReflectionPad2DBackward0         0.08%     291.682ms         0.85%        3.252s     135.507us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     591.42 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.12%     476.029ms         0.77%        2.960s     123.354us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     591.42 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.31%        1.196s         0.78%        2.987s     119.487us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -589.41 Gb   -1012.95 Gb         25000  
                                     LeakyReluBackward1         0.09%     355.757ms         0.47%        1.791s      71.631us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.54 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.25%     944.977ms         0.37%        1.435s      57.400us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.54 Gb     423.54 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.49%        1.877s         1.89%        7.256s     241.857us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -593.80 Gb   -1190.07 Gb         30000  
                                CudnnBatchNormBackward0         0.14%     535.145ms         1.40%        5.379s     179.287us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.27 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.50%        1.935s         1.26%        4.843s     161.449us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.27 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      94.009ms         0.11%     408.663ms      81.733us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      76.851ms         0.08%     314.654ms      62.931us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      73.060ms         0.18%     705.341ms     141.068us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.11 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      52.910ms         0.16%     632.281ms     126.456us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.11 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.07%     283.335ms         0.15%     579.371ms     115.874us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.11 Gb      42.11 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.511s        99.71%        2.511s      15.432us           0 b           0 b           0 b           0 b        162697  
                                             aten::item         0.01%      21.072ms         0.03%     115.708ms      57.854us       0.000us         0.00%       2.078ms       1.039us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      25.929ms         0.02%      94.636ms      47.318us       2.078ms         0.08%       2.078ms       1.039us           0 b           0 b           0 b           0 b          2000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 383.234s
Self CUDA time total: 2.518s
