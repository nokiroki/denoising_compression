-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      32.117ms         0.02%      76.788ms      38.356us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.19%        8.057s         2.19%        8.061s      14.558us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1805.39 Gb    1805.39 Gb        553728  
                                            aten::zero_         0.46%        1.696s         1.48%        5.427s      31.162us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        174144  
                                      model_performance        55.16%      202.924s        84.83%      312.106s      312.106s       0.000us         0.00%        2.529s        2.529s      -1.09 Mb     -15.64 Gb       1.15 Mb   -2170.26 Gb             1  
                                            aten::stack         0.00%     456.000us         0.04%     158.519ms      13.210ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      76.951ms         0.17%     615.683ms     122.719us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.08%     308.232ms         0.15%     538.732ms     107.381us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.26%     940.615ms         0.26%     948.499ms      30.554us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     827.27 Gb     827.27 Gb         31043  
                                           aten::narrow         0.02%      79.855ms         0.06%     228.156ms      22.675us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     120.502ms         0.04%     148.319ms      14.739us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     121.302ms         0.03%     121.302ms       3.271us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     236.106ms         0.06%     236.106ms       3.932us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     295.000us         0.02%      73.443ms       6.120ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     153.000us         0.00%       1.378ms     114.833us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.46%        1.697s         1.04%        3.831s      22.127us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        173155  
                                           aten::select         0.00%     316.000us         0.00%     373.000us      15.542us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.58%        2.119s         3.02%       11.120s      76.161us        2.526s        99.83%        2.526s      17.304us           0 b           0 b           0 b           0 b        146004  
                                               aten::to         0.23%     830.173ms         4.45%       16.377s     112.297us       0.000us         0.00%        2.526s      17.322us      15.46 Gb           0 b      35.00 Mb           0 b        145836  
                aten::_has_compatible_shallow_copy_type         0.00%     241.000us         0.00%     241.000us       0.849us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           284  
                                         aten::uniform_         0.02%      71.794ms         0.02%      71.794ms      71.794ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.16%        4.277s         2.19%        8.057s      28.368us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        284001  
                                         aten::_to_copy         0.58%        2.126s         4.23%       15.547s     106.775us       0.000us         0.00%        2.526s      17.350us      15.46 Gb           0 b      35.00 Mb           0 b        145604  
                                    aten::empty_strided         0.68%        2.486s         0.68%        2.486s      16.905us       0.000us         0.00%       0.000us       0.000us      15.46 Gb      15.46 Gb     101.87 Mb     101.87 Mb        147032  
                                        cudaMemcpyAsync         2.40%        8.837s         2.40%        8.837s      59.717us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147979  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.609ms         0.18%       4.609ms       2.304ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.06%     237.816ms         0.06%     237.816ms       1.609us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147835  
                                        aten::unsqueeze         0.00%     493.000us         0.00%     500.000us     500.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.22%     796.558ms         0.41%        1.493s      10.186us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                                 detach         0.19%     696.800ms         0.19%     696.800ms       4.753us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                            aten::clone         0.00%      34.000us         0.00%     543.000us     271.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.44%        1.616s         1.53%        5.633s       5.633ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      27.700ms         0.01%      47.229ms      47.229us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.01%       29.470s         8.01%       29.470s      14.705us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2004047  
                                              aten::mul         0.03%      97.999ms         0.04%     143.226ms      47.774us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.54 Gb      37.54 Gb          2998  
                                              aten::add         0.05%     183.353ms         0.07%     272.589ms      45.439us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.57 Gb      76.57 Gb          5999  
                                 aten::reflection_pad2d         0.20%     719.507ms         0.59%        2.172s      83.445us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.39 Gb           0 b         26026  
                                           aten::conv2d         0.14%     509.708ms         2.60%        9.580s     170.898us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     507.66 Gb           0 b         56056  
                                      aten::convolution         0.33%        1.210s         2.47%        9.070s     161.805us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     507.66 Gb           0 b         56056  
                                     aten::_convolution         0.30%        1.100s         2.14%        7.860s     140.221us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     507.66 Gb           0 b         56056  
                                aten::cudnn_convolution         0.84%        3.084s         1.55%        5.694s     101.582us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     507.66 Gb     501.54 Gb         56056  
                                        cudaEventRecord         0.14%     509.627ms         0.14%     509.627ms       2.238us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        227756  
                                        cudaBindTexture         0.15%     541.765ms         0.15%     541.765ms       4.288us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        126346  
                                      cudaUnbindTexture         0.04%     139.046ms         0.04%     139.046ms       1.101us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        126346  
                                          aten::reshape         0.05%     186.492ms         0.07%     264.226ms      10.152us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      77.734ms         0.02%      77.734ms       2.987us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.07%        7.629s         4.03%       14.826s      30.764us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        481914  
                                       aten::batch_norm         0.07%     244.581ms         1.45%        5.343s     177.932us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.08%     300.633ms         1.39%        5.099s     169.788us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.55%        2.030s         1.30%        4.798s     159.777us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                       aten::empty_like         0.15%     548.317ms         0.50%        1.829s      32.473us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1187.12 Gb           0 b         56314  
                                      aten::leaky_relu_         0.16%     589.601ms         0.26%     973.065ms      38.884us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.01%      43.889ms         0.01%      43.889ms     510.337us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            86  
                               cudaEventCreateWithFlags         0.00%       5.549ms         0.00%       5.549ms      32.262us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           172  
                                   cudaEventSynchronize         0.11%     398.266ms         0.11%     398.266ms     877.238us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           454  
                                   cudaEventElapsedTime         0.00%       1.890ms         0.00%       1.890ms       4.163us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           454  
                                        cudaEventCreate         0.00%      11.600ms         0.00%      11.600ms     203.509us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            57  
                                    cudaStreamWaitEvent         0.00%       4.753ms         0.00%       4.753ms       1.605us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2961  
                                       cudaEventDestroy         0.00%     305.000us         0.00%     305.000us       1.332us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           229  
                                               cudaFree         0.02%      86.943ms         0.02%      86.943ms       2.898ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            30  
                                             cudaMalloc         0.05%     183.523ms         0.05%     183.523ms       5.398ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            34  
                              aten::upsample_bilinear2d         0.06%     226.246ms         0.08%     307.398ms      61.418us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      42.314ms         0.02%      69.938ms      69.868us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       2.879ms         0.00%       2.879ms       2.879us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      46.967ms         0.06%     212.274ms     212.274us       0.000us         0.00%     177.000us       0.177us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.03%      92.560ms         0.03%     127.045ms     127.045us     177.000us         0.01%     177.000us       0.177us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.37%        1.360s         0.37%        1.360s      23.407us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         58116  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.301ms         0.09%       2.301ms       0.176us           0 b           0 b           0 b           0 b         13059  
                                        aten::ones_like         0.00%      12.512ms         0.02%      68.802ms      68.802us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      49.620ms         0.14%     512.157ms     512.157us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      37.488ms         0.13%     462.537ms     462.537us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.04%     153.073ms         0.15%     542.722ms     271.361us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     348.633ms         0.67%        2.462s      97.384us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.35 Gb           0 b         25284  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      34.379ms         0.04%     140.440ms     140.440us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     119.08 Mb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      19.526ms         0.03%     106.061ms     106.061us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.05 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      57.494ms         0.02%      86.535ms      86.535us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.05 Gb       3.05 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.95%        3.513s         6.89%       25.355s     452.762us       0.000us         0.00%       2.124ms       0.038us           0 b           0 b    -567.18 Gb   -1245.33 Gb         56000  
                                   ConvolutionBackward0         0.29%        1.076s         5.94%       21.842s     390.033us       0.000us         0.00%       2.124ms       0.038us           0 b           0 b     678.15 Gb           0 b         56000  
                             aten::convolution_backward         2.59%        9.539s         5.64%       20.766s     370.824us       1.600ms         0.06%       2.124ms       0.038us           0 b           0 b     678.15 Gb     665.14 Gb         56000  
                                              aten::sum         0.47%        1.736s         0.64%        2.350s      90.372us     524.000us         0.02%     524.000us       0.020us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         2.14%        7.888s         4.00%       14.731s     103.736us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -794.61 Mb    -795.41 Mb        142000  
                        torch::autograd::AccumulateGrad         0.43%        1.583s         1.86%        6.842s      48.186us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     814.50 Kb           0 b        142000  
                                aten::new_empty_strided         0.01%      48.336ms         0.02%      84.068ms     592.028us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     814.50 Kb           0 b           142  
autograd::engine::evaluate_function: ReflectionPad2D...         0.23%     854.558ms         1.16%        4.269s     177.876us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -217.53 Gb    -850.23 Gb         24000  
                               ReflectionPad2DBackward0         0.08%     296.967ms         0.88%        3.230s     134.572us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.42 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.13%     473.643ms         0.80%        2.933s     122.198us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.42 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.24%     868.291ms         0.71%        2.616s     104.658us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -589.64 Gb   -1013.63 Gb         25000  
                                     LeakyReluBackward1         0.09%     333.950ms         0.48%        1.748s      69.927us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.99 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.25%     927.067ms         0.38%        1.414s      56.569us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.99 Gb     423.99 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.48%        1.779s         1.90%        7.006s     233.518us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -593.97 Gb   -1190.17 Gb         30000  
                                CudnnBatchNormBackward0         0.15%     544.752ms         1.42%        5.226s     174.216us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.20 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.51%        1.862s         1.27%        4.682s     156.057us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.20 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      73.601ms         0.10%     376.040ms      75.208us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      76.113ms         0.08%     302.439ms      60.488us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      71.036ms         0.19%     696.859ms     139.372us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      51.088ms         0.17%     625.823ms     125.165us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.08%     281.378ms         0.16%     574.735ms     114.947us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb      42.60 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.524s        99.73%        2.524s      17.073us           0 b           0 b           0 b           0 b        147830  
                                             aten::item         0.01%      24.957ms         0.03%     117.119ms      58.559us       0.000us         0.00%       2.078ms       1.039us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      26.064ms         0.03%      92.162ms      46.081us       2.078ms         0.08%       2.078ms       1.039us           0 b           0 b           0 b           0 b          2000  
                               Optimizer.step#Adam.step         7.87%       28.947s        17.56%       64.599s      64.599ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb       1.59 Mb      -1.55 Gb          1000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 367.902s
Self CUDA time total: 2.531s
