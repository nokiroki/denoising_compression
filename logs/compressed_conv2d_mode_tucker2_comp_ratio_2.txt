-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      23.448ms         0.02%      56.185ms      28.064us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.73%        9.645s         2.74%        9.659s      17.444us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    2038.59 Gb    2038.59 Gb        553728  
                                            aten::zero_         0.42%        1.483s         1.44%        5.079s      29.167us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        174144  
                                      model_performance        53.65%      189.442s        85.58%      302.205s      302.205s       0.000us         0.00%        2.398s        2.398s      -4.45 Mb     -18.77 Gb       4.42 Mb   -2390.86 Gb             1  
                                            aten::stack         0.00%       2.040ms         0.05%     178.198ms      14.850ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      68.490ms         0.17%     590.446ms     117.689us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.09%     306.525ms         0.15%     521.956ms     104.037us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.14%     505.762ms         0.14%     506.605ms      16.319us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb     826.97 Gb     826.97 Gb         31043  
                                           aten::narrow         0.02%      81.881ms         0.07%     230.450ms      22.903us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     120.255ms         0.04%     148.621ms      14.769us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     122.630ms         0.03%     122.630ms       3.306us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     224.692ms         0.06%     224.692ms       3.742us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     280.000us         0.02%      65.553ms       5.463ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     132.000us         0.00%     596.000us      49.667us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.45%        1.589s         1.04%        3.688s      21.299us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        173155  
                                           aten::select         0.00%     298.000us         0.00%     344.000us      14.333us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.57%        2.013s         5.89%       20.788s     142.380us        2.396s        99.82%        2.396s      16.409us           0 b           0 b           0 b           0 b        146004  
                                               aten::to         0.20%     700.528ms         7.09%       25.053s     171.786us       0.000us         0.00%        2.395s      16.424us      18.59 Gb           0 b      35.00 Mb           0 b        145836  
                aten::_has_compatible_shallow_copy_type         0.00%     519.000us         0.00%     519.000us       1.827us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           284  
                                         aten::uniform_         0.02%      76.283ms         0.02%      76.283ms      76.283ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.14%        4.016s         2.17%        7.673s      27.016us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        284001  
                                         aten::_to_copy         0.50%        1.766s         6.90%       24.352s     167.249us       0.000us         0.00%        2.395s      16.450us      18.59 Gb           0 b      35.00 Mb           0 b        145604  
                                    aten::empty_strided         0.55%        1.958s         0.55%        1.959s      13.321us       0.000us         0.00%       0.000us       0.000us      18.59 Gb      18.59 Gb     111.58 Mb     111.58 Mb        147032  
                                        cudaMemcpyAsync         5.27%       18.593s         5.27%       18.593s     125.647us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147979  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       5.663ms         0.24%       5.663ms       2.832ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.07%     243.846ms         0.07%     243.846ms       1.649us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        147835  
                                        aten::unsqueeze         0.00%      52.000us         0.00%      58.000us      58.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.19%     660.564ms         0.36%        1.287s       8.777us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                                 detach         0.18%     626.172ms         0.18%     626.172ms       4.271us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        146603  
                                            aten::clone         0.00%      51.000us         0.00%     308.000us     154.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.40%        1.401s         1.44%        5.096s       5.096ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      25.425ms         0.01%      44.235ms      44.235us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.21%       29.005s         8.21%       29.005s      14.280us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2031165  
                                              aten::mul         0.03%      92.745ms         0.04%     136.860ms      45.650us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.33 Gb      37.33 Gb          2998  
                                              aten::add         0.05%     173.366ms         0.07%     261.548ms      43.599us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      77.45 Gb      77.45 Gb          5999  
                                 aten::reflection_pad2d         0.19%     656.062ms         0.47%        1.657s      63.672us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.09 Gb           0 b         26026  
                                           aten::conv2d         0.12%     425.310ms         2.59%        9.140s     163.046us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     728.21 Gb           0 b         56056  
                                      aten::convolution         0.27%     968.002ms         2.47%        8.714s     155.459us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     728.21 Gb           0 b         56056  
                                     aten::_convolution         0.25%     896.347ms         2.19%        7.746s     138.190us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     728.21 Gb           0 b         56056  
                                aten::cudnn_convolution         0.83%        2.930s         1.66%        5.845s     104.275us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     728.21 Gb     716.55 Gb         56056  
                                        cudaEventRecord         0.15%     524.531ms         0.15%     524.531ms       2.298us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        228223  
                                        cudaBindTexture         0.14%     495.036ms         0.14%     495.036ms       4.524us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        109415  
                                      cudaUnbindTexture         0.03%     115.461ms         0.03%     115.461ms       1.055us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        109415  
                                          aten::reshape         0.05%     160.150ms         0.07%     232.525ms       8.934us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      72.375ms         0.02%      72.375ms       2.781us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.08%        7.345s         4.07%       14.376s      29.832us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        481914  
                                       aten::batch_norm         0.06%     214.163ms         1.35%        4.760s     158.512us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.07%     250.342ms         1.29%        4.546s     151.380us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.50%        1.779s         1.22%        4.296s     143.044us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                       aten::empty_like         0.14%     498.032ms         0.48%        1.689s      29.989us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1186.89 Gb           0 b         56314  
                                      aten::leaky_relu_         0.15%     546.416ms         0.26%     919.470ms      36.742us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.02%      72.852ms         0.02%      72.852ms     662.291us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           110  
                               cudaEventCreateWithFlags         0.00%     767.000us         0.00%     767.000us       3.486us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           220  
                                   cudaEventSynchronize         0.23%     799.641ms         0.23%     799.641ms       1.362ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           587  
                                   cudaEventElapsedTime         0.00%       3.502ms         0.00%       3.502ms       5.966us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           587  
                                        cudaEventCreate         0.00%     250.000us         0.00%     250.000us       3.425us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            73  
                                    cudaStreamWaitEvent         0.00%       3.997ms         0.00%       3.997ms       1.138us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          3512  
                                       cudaEventDestroy         0.00%     520.000us         0.00%     520.000us       1.775us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           293  
                                             cudaMalloc         0.06%     216.043ms         0.06%     216.043ms       8.002ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            27  
                                               cudaFree         0.02%      63.597ms         0.02%      63.597ms       4.892ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            13  
                              aten::upsample_bilinear2d         0.06%     198.618ms         0.08%     277.923ms      55.529us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      39.438ms         0.02%      59.550ms      59.491us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       2.520ms         0.00%       2.520ms       2.520us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      41.713ms         0.05%     192.502ms     192.502us       0.000us         0.00%      77.000us       0.077us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.02%      81.396ms         0.03%     114.386ms     114.386us      77.000us         0.00%      77.000us       0.077us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.35%        1.220s         0.35%        1.220s      22.951us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         53148  
                                        aten::ones_like         0.00%      10.537ms         0.02%      61.122ms      61.122us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      41.519ms         0.14%     481.660ms     481.660us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.04%     152.013ms         0.12%     440.141ms     440.141us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.02%      73.688ms         0.10%     343.247ms     171.624us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.09%     319.315ms         0.67%        2.353s      93.058us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.13 Gb           0 b         25284  
autograd::engine::evaluate_function: SigmoidBackward...         0.02%      53.917ms         0.04%     157.473ms     157.473us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     113.81 Mb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      19.562ms         0.03%     103.556ms     103.556us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.04 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      54.285ms         0.02%      83.994ms      83.994us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.04 Gb       3.04 Gb          1000  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.415ms         0.10%       2.415ms       0.172us           0 b           0 b           0 b           0 b         14075  
autograd::engine::evaluate_function: ConvolutionBack...         0.76%        2.673s         7.04%       24.845s     443.665us       0.000us         0.00%       2.338ms       0.042us           0 b           0 b    -785.94 Gb   -1686.58 Gb         56000  
                                   ConvolutionBackward0         0.30%        1.053s         6.28%       22.172s     395.933us       0.000us         0.00%       2.338ms       0.042us           0 b           0 b     900.64 Gb           0 b         56000  
                             aten::convolution_backward         2.25%        7.936s         5.98%       21.120s     377.138us       2.135ms         0.09%       2.338ms       0.042us           0 b           0 b     900.64 Gb     659.34 Gb         56000  
                                              aten::sum         0.48%        1.678s         0.65%        2.286s      87.909us     203.000us         0.01%     203.000us       0.008us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.06%        3.748s         2.99%       10.566s      74.405us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      -3.93 Gb      -3.94 Gb        142000  
                        torch::autograd::AccumulateGrad         0.45%        1.583s         1.93%        6.818s      48.012us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       4.03 Mb           0 b        142000  
                                aten::new_empty_strided         0.00%       4.305ms         0.00%      10.129ms      71.331us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       4.03 Mb           0 b           142  
autograd::engine::evaluate_function: ReflectionPad2D...         0.24%     850.612ms         1.18%        4.171s     173.788us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -216.33 Gb    -849.12 Gb         24000  
                               ReflectionPad2DBackward0         0.08%     276.416ms         0.89%        3.138s     130.752us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.19 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.13%     456.250ms         0.81%        2.862s     119.234us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.19 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.24%     853.833ms         0.77%        2.702s     108.078us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -590.56 Gb   -1013.30 Gb         25000  
                                     LeakyReluBackward1         0.10%     337.053ms         0.52%        1.848s      73.925us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     422.74 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.28%     998.725ms         0.43%        1.511s      60.443us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     422.74 Gb     422.74 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.49%        1.713s         1.94%        6.868s     228.925us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -592.56 Gb   -1188.35 Gb         30000  
                                CudnnBatchNormBackward0         0.15%     520.765ms         1.46%        5.155s     171.836us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.79 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.53%        1.857s         1.31%        4.634s     154.477us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     595.79 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      74.627ms         0.11%     378.491ms      75.698us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      75.130ms         0.09%     303.864ms      60.773us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      75.557ms         0.20%     703.140ms     140.628us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      52.199ms         0.18%     627.583ms     125.517us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.08%     276.260ms         0.16%     575.384ms     115.077us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb      42.60 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.392s        99.66%        2.392s      16.182us           0 b           0 b           0 b           0 b        147833  
                                             aten::item         0.00%      13.803ms         0.03%      95.954ms      47.977us       0.000us         0.00%       2.014ms       1.007us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      20.724ms         0.02%      82.151ms      41.075us       2.014ms         0.08%       2.014ms       1.007us           0 b           0 b           0 b           0 b          2000  
                               Optimizer.step#Adam.step         7.99%       28.210s        17.57%       62.031s      62.031ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb       8.06 Mb      -7.87 Gb          1000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 353.118s
Self CUDA time total: 2.400s
