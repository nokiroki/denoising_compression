-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::zeros         0.01%      34.369ms         0.02%      94.951ms      47.428us       0.000us         0.00%       0.000us       0.000us      32.01 Mb           0 b           0 b           0 b          2002  
                                            aten::empty         2.43%        9.894s         2.44%        9.914s      16.982us       0.000us         0.00%       0.000us       0.000us     105.70 Mb     105.70 Mb    1816.98 Gb    1816.98 Gb        583773  
                                            aten::zero_         0.48%        1.969s         1.53%        6.238s      32.979us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        189159  
                                      model_performance        52.76%      214.775s        86.05%      350.306s      350.306s       0.000us         0.00%        2.565s        2.565s      -3.30 Kb     -15.63 Gb     446.00 Kb   -2269.50 Gb             1  
                                            aten::stack         0.00%       2.460ms         0.04%     183.035ms      15.253ms       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b           0 b           0 b            12  
                                              aten::cat         0.02%      89.167ms         0.17%     675.926ms     134.727us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                             aten::_cat         0.08%     337.903ms         0.14%     586.759ms     116.954us       0.000us         0.00%       0.000us       0.000us      72.00 Mb           0 b     171.88 Gb           0 b          5017  
                                          aten::resize_         0.59%        2.401s         0.59%        2.411s      19.916us       0.000us         0.00%       0.000us       0.000us      72.00 Mb      72.00 Mb    1068.34 Gb    1068.34 Gb        121073  
                                           aten::narrow         0.02%      82.232ms         0.06%     233.834ms      23.239us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10062  
                                            aten::slice         0.03%     123.277ms         0.04%     151.615ms      15.067us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         10063  
                                       aten::as_strided         0.03%     127.610ms         0.03%     127.610ms       3.441us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         37088  
                                             aten::view         0.06%     250.776ms         0.06%     250.776ms       4.177us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         60042  
                                         aten::new_full         0.00%     322.000us         0.02%      78.867ms       6.572ms       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                        aten::new_empty         0.00%     166.000us         0.00%       1.819ms     151.583us       0.000us         0.00%       0.000us       0.000us      72.99 Mb           0 b           0 b           0 b            12  
                                            aten::fill_         0.47%        1.907s         1.07%        4.376s      23.257us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        188170  
                                           aten::select         0.00%     284.000us         0.00%     333.000us      13.875us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            24  
                                            aten::copy_         0.60%        2.424s         4.38%       17.843s     110.908us        2.563s        99.82%        2.563s      15.931us           0 b           0 b           0 b           0 b        160884  
                                               aten::to         0.25%     999.288ms         5.97%       24.294s     151.175us       0.000us         0.00%        2.563s      15.947us      15.46 Gb           0 b      35.00 Mb           0 b        160701  
                aten::_has_compatible_shallow_copy_type         0.00%     262.000us         0.00%     262.000us       0.834us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           314  
                                         aten::uniform_         0.01%      57.203ms         0.01%      57.203ms      57.203ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                             aten::mul_         1.23%        4.997s         2.31%        9.415s      29.983us       0.000us         0.00%       0.000us       0.000us           0 b          -4 b           0 b           0 b        314001  
                                         aten::_to_copy         0.62%        2.511s         5.72%       23.295s     145.179us       0.000us         0.00%        2.563s      15.971us      15.46 Gb           0 b      35.00 Mb           0 b        160454  
                                    aten::empty_strided         0.77%        3.123s         0.77%        3.123s      19.284us       0.000us         0.00%       0.000us       0.000us      15.46 Gb      15.46 Gb     101.87 Mb     101.87 Mb        161927  
                                        cudaMemcpyAsync         3.73%       15.198s         3.73%       15.198s      93.318us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162859  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       4.673ms         0.18%       4.673ms       2.337ms           0 b           0 b           0 b           0 b             2  
                                  cudaStreamSynchronize         0.07%     300.045ms         0.07%     300.045ms       1.844us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        162700  
                                        aten::unsqueeze         0.00%      27.000us         0.00%      32.000us      32.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                                           aten::detach         0.24%     985.326ms         0.44%        1.805s      11.182us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                                 detach         0.20%     819.985ms         0.20%     819.985ms       5.079us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        161453  
                                            aten::clone         0.00%      40.000us         0.00%     535.000us     267.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Mb           0 b             2  
                     Optimizer.zero_grad#Adam.zero_grad         0.46%        1.889s         1.64%        6.681s       6.681ms       0.000us         0.00%       0.000us       0.000us      -3.91 Kb    -363.28 Kb           0 b           0 b          1000  
                                          aten::normal_         0.01%      29.702ms         0.01%      50.372ms      50.372us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                       cudaLaunchKernel         8.23%       33.513s         8.23%       33.513s      15.411us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b       2174522  
                                              aten::mul         0.03%     104.777ms         0.04%     153.486ms      51.196us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      37.10 Gb      37.10 Gb          2998  
                                              aten::add         0.05%     217.468ms         0.08%     310.672ms      51.787us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      76.50 Gb      76.50 Gb          5999  
                                 aten::reflection_pad2d         0.19%     768.805ms         0.47%        1.907s      73.270us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     655.09 Gb           0 b         26026  
                                           aten::conv2d         0.17%     684.524ms         2.88%       11.724s     164.969us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     607.60 Gb           0 b         71071  
                                      aten::convolution         0.40%        1.625s         2.71%       11.040s     155.337us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     607.60 Gb           0 b         71071  
                                     aten::_convolution         0.38%        1.562s         2.31%        9.414s     132.466us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     607.60 Gb           0 b         71071  
                                aten::cudnn_convolution         0.61%        2.492s         1.15%        4.688s     114.227us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     494.73 Gb     490.98 Gb         41041  
                                        cudaEventRecord         0.11%     455.249ms         0.11%     455.249ms       2.417us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        188359  
                                        cudaBindTexture         0.11%     434.671ms         0.11%     434.671ms       4.661us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         93251  
                                      cudaUnbindTexture         0.03%     107.015ms         0.03%     107.015ms       1.148us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         93251  
                                          aten::reshape         0.05%     218.071ms         0.07%     303.680ms      11.668us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                   aten::_reshape_alias         0.02%      85.609ms         0.02%      85.609ms       3.289us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         26026  
                                             aten::add_         2.17%        8.842s         4.19%       17.069s      32.395us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        526899  
                                       aten::batch_norm         0.07%     277.793ms         1.70%        6.940s     231.092us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                           aten::_batch_norm_impl_index         0.08%     343.166ms         1.64%        6.662s     221.842us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                 aten::cudnn_batch_norm         0.52%        2.111s         1.55%        6.319s     210.414us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.80 Gb           0 b         30030  
                                       aten::empty_like         0.14%     554.823ms         0.50%        2.024s      35.920us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    1186.99 Gb           0 b         56344  
                                      aten::leaky_relu_         0.16%     632.214ms         0.26%        1.039s      41.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         25025  
                                         cudaMemGetInfo         0.01%      26.583ms         0.01%      26.583ms     408.969us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            65  
                               cudaEventCreateWithFlags         0.00%     356.000us         0.00%     356.000us       2.738us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           130  
                                   cudaEventSynchronize         0.10%     391.947ms         0.10%     391.947ms       1.177ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           333  
                                   cudaEventElapsedTime         0.00%       1.728ms         0.00%       1.728ms       5.189us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           333  
                                        cudaEventCreate         0.00%     117.000us         0.00%     117.000us       2.721us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            43  
                                    cudaStreamWaitEvent         0.00%       7.241ms         0.00%       7.241ms       1.038us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          6979  
                                       cudaEventDestroy         0.00%     255.000us         0.00%     255.000us       1.474us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           173  
                                               cudaFree         0.02%      83.124ms         0.02%      83.124ms       5.195ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            16  
                                aten::_conv_depthwise2d         0.17%     675.652ms         0.49%        2.004s      66.749us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     112.87 Gb           0 b         30030  
                                             cudaMalloc         0.05%     219.944ms         0.05%     219.944ms       9.997ms       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            22  
                              aten::upsample_bilinear2d         0.06%     240.018ms         0.08%     328.109ms      65.556us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     166.67 Gb     166.67 Gb          5005  
                                          aten::sigmoid         0.01%      49.249ms         0.02%      71.545ms      71.474us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb       2.93 Gb          1001  
                                aten::broadcast_tensors         0.00%       3.003ms         0.00%       3.003ms       3.003us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1000  
                                         aten::mse_loss         0.01%      50.124ms         0.06%     231.310ms     231.310us       0.000us         0.00%     186.000us       0.186us           0 b           0 b     500.00 Kb      -2.93 Gb          1000  
                                             aten::mean         0.02%      99.454ms         0.03%     137.106ms     137.106us     186.000us         0.01%     186.000us       0.186us           0 b           0 b     500.00 Kb     500.00 Kb          1000  
                                        cudaMemsetAsync         0.27%        1.094s         0.27%        1.094s      24.812us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         44088  
                                        aten::ones_like         0.00%      13.431ms         0.02%      73.435ms      73.435us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     500.00 Kb           0 b          1000  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.624ms         0.10%       2.624ms       0.201us           0 b           0 b           0 b           0 b         13045  
autograd::engine::evaluate_function: MseLossBackward...         0.01%      39.293ms         0.11%     454.638ms     454.638us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                       MseLossBackward0         0.01%      26.704ms         0.10%     415.345ms     415.345us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          1000  
                                aten::mse_loss_backward         0.03%     141.430ms         0.13%     516.041ms     258.021us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       2.93 Gb           0 b          2000  
                                       aten::zeros_like         0.08%     334.360ms         0.61%        2.485s      98.150us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     593.23 Gb           0 b         25314  
autograd::engine::evaluate_function: SigmoidBackward...         0.01%      40.732ms         0.04%     165.080ms     165.080us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     161.22 Mb      -2.93 Gb          1000  
                                       SigmoidBackward0         0.01%      22.387ms         0.03%     124.348ms     124.348us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.09 Gb           0 b          1000  
                                 aten::sigmoid_backward         0.02%      66.928ms         0.03%     101.961ms     101.961us       0.000us         0.00%       0.000us       0.000us           0 b           0 b       3.09 Gb       3.09 Gb          1000  
autograd::engine::evaluate_function: ConvolutionBack...         0.72%        2.939s         6.57%       26.745s     376.695us       0.000us         0.00%       2.438ms       0.034us           0 b           0 b    -669.28 Gb   -1446.64 Gb         71000  
                                   ConvolutionBackward0         0.33%        1.363s         5.85%       23.806s     335.302us       0.000us         0.00%       2.438ms       0.034us           0 b           0 b     777.37 Gb           0 b         71000  
                             aten::convolution_backward         2.42%        9.853s         5.51%       22.443s     316.105us       1.911ms         0.07%       2.438ms       0.034us           0 b           0 b     777.37 Gb     622.24 Gb         71000  
                                              aten::sum         0.44%        1.786s         0.59%        2.412s      92.772us     527.000us         0.02%     527.000us       0.020us           0 b           0 b      12.70 Mb      12.70 Mb         26000  
autograd::engine::evaluate_function: torch::autograd...         1.06%        4.333s         2.95%       12.007s      76.479us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -793.64 Mb    -794.43 Mb        157000  
                        torch::autograd::AccumulateGrad         0.43%        1.735s         1.89%        7.674s      48.881us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     813.50 Kb           0 b        157000  
                                aten::new_empty_strided         0.00%       1.466ms         0.00%      12.357ms      78.707us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     813.50 Kb           0 b           157  
autograd::engine::evaluate_function: ReflectionPad2D...         0.23%     920.015ms         1.09%        4.422s     184.249us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -217.34 Gb    -849.81 Gb         24000  
                               ReflectionPad2DBackward0         0.07%     292.802ms         0.81%        3.286s     136.920us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.30 Gb           0 b         24000  
                        aten::reflection_pad2d_backward         0.12%     482.154ms         0.74%        2.993s     124.720us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     590.30 Gb           0 b         24000  
autograd::engine::evaluate_function: LeakyReluBackwa...         0.65%        2.643s         1.10%        4.482s     179.277us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -589.91 Gb   -1013.08 Gb         25000  
                                     LeakyReluBackward1         0.09%     349.773ms         0.45%        1.839s      73.546us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.17 Gb           0 b         25000  
                              aten::leaky_relu_backward         0.24%     981.732ms         0.37%        1.489s      59.555us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     423.17 Gb     423.17 Gb         25000  
autograd::engine::evaluate_function: CudnnBatchNormB...         0.47%        1.898s         1.80%        7.320s     243.996us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -591.79 Gb   -1188.47 Gb         30000  
                                CudnnBatchNormBackward0         0.13%     526.744ms         1.33%        5.422s     180.746us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.67 Gb           0 b         30000  
                        aten::cudnn_batch_norm_backward         0.48%        1.957s         1.20%        4.896s     163.188us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     596.67 Gb           0 b         30000  
      autograd::engine::evaluate_function: CatBackward0         0.02%      76.112ms         0.09%     384.488ms      76.898us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
                                           CatBackward0         0.02%      76.321ms         0.08%     308.376ms      61.675us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5000  
autograd::engine::evaluate_function: UpsampleBilinea...         0.02%      74.926ms         0.18%     728.398ms     145.680us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                            UpsampleBilinear2DBackward1         0.01%      52.208ms         0.16%     653.472ms     130.694us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb           0 b          5000  
                     aten::upsample_bilinear2d_backward         0.07%     291.309ms         0.15%     601.264ms     120.253us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      42.60 Gb      42.60 Gb          5000  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us        2.560s        99.72%        2.560s      15.737us           0 b           0 b           0 b           0 b        162695  
                                             aten::item         0.01%      22.593ms         0.03%     120.137ms      60.069us       0.000us         0.00%       2.041ms       1.020us           0 b           0 b           0 b           0 b          2000  
                              aten::_local_scalar_dense         0.01%      26.800ms         0.02%      97.544ms      48.772us       2.041ms         0.08%       2.041ms       1.020us           0 b           0 b           0 b           0 b          2000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 407.111s
Self CUDA time total: 2.568s
